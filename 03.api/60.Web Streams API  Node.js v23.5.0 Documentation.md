# 웹 스트림 API(Web Streams API)

[WHATWG 스트림 표준](https://streams.spec.whatwg.org/)을 구현한 API입니다.


### 개요

[WHATWG 스트림 표준](https://streams.spec.whatwg.org/) (또는 "웹 스트림")은 스트리밍 데이터를 처리하기 위한 API를 정의합니다. 이는 Node.js의 [스트림](https://nodejs.org/docs/latest/api/webstreams.htmlstream.html) API와 유사하지만, 더 최근에 등장했으며 다양한 자바스크립트 환경에서 스트리밍 데이터를 다루는 "표준" API로 자리 잡았습니다.

주요 객체 타입은 세 가지입니다:

-   `ReadableStream` - 스트리밍 데이터의 출처를 나타냅니다.
-   `WritableStream` - 스트리밍 데이터의 목적지를 나타냅니다.
-   `TransformStream` - 스트리밍 데이터를 변환하는 알고리즘을 나타냅니다.


### API[#](https://nodejs.org/docs/latest/api/webstreams.html#api)





#### Class: `ReadableStream`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)





##### `new ReadableStream([underlyingSource [, strategy]])`[#](https://nodejs.org/docs/latest/api/webstreams.html#new-readablestreamunderlyingsource--strategy)

추가된 버전: v16.5.0

-   `underlyingSource` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `start` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) `ReadableStream`이 생성될 때 즉시 호출되는 사용자 정의 함수.
        -   `controller` [`<ReadableStreamDefaultController>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestreamdefaultcontroller) | [`<ReadableByteStreamController>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablebytestreamcontroller)
        -   반환값: `undefined` 또는 `undefined`로 이행된 Promise.
    -   `pull` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) `ReadableStream`의 내부 큐가 가득 차지 않았을 때 반복적으로 호출되는 사용자 정의 함수. 동기 또는 비동기로 동작할 수 있음. 비동기인 경우, 이전에 반환된 Promise가 이행될 때까지 다시 호출되지 않음.
        -   `controller` [`<ReadableStreamDefaultController>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestreamdefaultcontroller) | [`<ReadableByteStreamController>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablebytestreamcontroller)
        -   반환값: `undefined`로 이행된 Promise.
    -   `cancel` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) `ReadableStream`이 취소될 때 호출되는 사용자 정의 함수.
        -   `reason` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
        -   반환값: `undefined`로 이행된 Promise.
    -   `type` [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) `'bytes'` 또는 `undefined`여야 함.
    -   `autoAllocateChunkSize` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) `type`이 `'bytes'`일 때만 사용됨. 0이 아닌 값으로 설정되면 `ReadableByteStreamController.byobRequest`에 뷰 버퍼가 자동으로 할당됨. 설정되지 않으면 기본 리더 `ReadableStreamDefaultReader`를 통해 스트림의 내부 큐를 사용해 데이터를 전송해야 함.
-   `strategy` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `highWaterMark` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) 백프레셔가 적용되기 전의 최대 내부 큐 크기.
    -   `size` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 각 데이터 청크의 크기를 식별하는 데 사용되는 사용자 정의 함수.
        -   `chunk` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
        -   반환값: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)


##### `readableStream.locked`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamlocked)

추가된 버전: v16.5.0

-   타입: [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)  
    이 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)에 활성화된 리더가 있으면 `true`로 설정됩니다.

`readableStream.locked` 속성은 기본적으로 `false`이며, 스트림의 데이터를 소비하는 활성화된 리더가 있는 동안 `true`로 전환됩니다.


##### `readableStream.cancel([reason])`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamcancelreason)

추가된 버전: v16.5.0

-   `reason` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
-   반환값: 취소가 완료되면 `undefined`로 이행되는 Promise

`readableStream.cancel([reason])` 메서드는 스트림을 취소할 때 사용됩니다. 이 메서드를 호출하면 스트림이 즉시 닫히고, 이후 데이터를 읽을 수 없게 됩니다. `reason` 인자는 취소 이유를 설명하는 값으로, 어떤 타입이든 가능합니다. 이 메서드는 취소 작업이 완료되면 `undefined`로 이행되는 Promise를 반환합니다.

예제:
```javascript
const readableStream = new ReadableStream({
  start(controller) {
    controller.enqueue('Hello');
    controller.enqueue('World');
    controller.close();
  }
});

readableStream.cancel('User requested cancellation')
  .then(() => {
    console.log('Stream has been cancelled');
  });
```

이 예제에서는 `readableStream.cancel()`을 호출하여 스트림을 취소하고, 취소가 완료되면 콘솔에 메시지를 출력합니다.


##### `readableStream.getReader([options])`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamgetreaderoptions)

추가된 버전: v16.5.0

-   `options` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `mode` [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) `'byob'` 또는 `undefined`
-   반환값: [`<ReadableStreamDefaultReader>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestreamdefaultreader) | [`<ReadableStreamBYOBReader>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestreambyobreader)

```js
import { ReadableStream } from 'node:stream/web';
const stream = new ReadableStream();
const reader = stream.getReader();
console.log(await reader.read());
```

이 메서드를 호출하면 `readableStream.locked`가 `true`로 설정됩니다.


##### `readableStream.pipeThrough(transform[, options])`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreampipethroughtransform-options)

추가된 버전: v16.5.0

-   `transform` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `readable` [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream) `transform.writable`에서 받은 데이터를 변환하여 전달할 `ReadableStream`.
    -   `writable` [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream) 이 `ReadableStream`의 데이터를 쓸 `WritableStream`.
-   `options` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `preventAbort` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) `true`로 설정하면, 이 `ReadableStream`에서 발생한 오류가 `transform.writable`을 중단시키지 않는다.
    -   `preventCancel` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) `true`로 설정하면, 목적지 `transform.writable`에서 발생한 오류가 이 `ReadableStream`을 취소시키지 않는다.
    -   `preventClose` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) `true`로 설정하면, 이 `ReadableStream`이 닫혀도 `transform.writable`이 닫히지 않는다.
    -   `signal` [`<AbortSignal>`](https://nodejs.org/docs/latest/api/globals.html#class-abortsignal) [`<AbortController>`](https://nodejs.org/docs/latest/api/globals.html#class-abortcontroller)를 사용하여 데이터 전송을 취소할 수 있다.
-   반환값: [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream) `transform.readable`에서 반환된 `ReadableStream`.

이 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)을 `transform` 인자로 제공된 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)과 [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream) 쌍에 연결한다. 이렇게 하면 이 `ReadableStream`의 데이터가 `transform.writable`에 쓰여지고, 변환된 후 `transform.readable`로 전달된다. 파이프라인이 구성되면 `transform.readable`이 반환된다.

파이프 작업이 활성화된 동안 `readableStream.locked`가 `true`가 된다.

```js
import { ReadableStream, TransformStream } from 'node:stream/web';

const stream = new ReadableStream({
    start(controller) {
        controller.enqueue('a');
    },
});

const transform = new TransformStream({
    transform(chunk, controller) {
        controller.enqueue(chunk.toUpperCase());
    },
});

const transformedStream = stream.pipeThrough(transform);

for await (const chunk of transformedStream) {
    console.log(chunk); // 출력: A
}
```


##### `readableStream.pipeTo(destination[, options])`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreampipetodestination-options)

v16.5.0 버전에서 추가됨

-   `destination` [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)  
    `ReadableStream`의 데이터가 전달될 [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)입니다.
-   `options` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)  
    -   `preventAbort` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)  
        `true`로 설정하면, `ReadableStream`에서 발생한 오류가 `destination`을 중단시키지 않습니다.
    -   `preventCancel` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)  
        `true`로 설정하면, `destination`에서 발생한 오류가 `ReadableStream`을 취소시키지 않습니다.
    -   `preventClose` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)  
        `true`로 설정하면, `ReadableStream`이 닫히더라도 `destination`이 닫히지 않습니다.
    -   `signal` [`<AbortSignal>`](https://nodejs.org/docs/latest/api/globals.html#class-abortsignal)  
        [`<AbortController>`](https://nodejs.org/docs/latest/api/globals.html#class-abortcontroller)를 사용하여 데이터 전송을 취소할 수 있습니다.
-   반환값: `undefined`로 이행되는 Promise

파이프 작업이 활성화된 동안 `readableStream.locked`를 `true`로 설정합니다.


##### `readableStream.tee()`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamtee)

-   반환값: [`<ReadableStream\[\]>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)

이 `ReadableStream`의 데이터를 전달받을 두 개의 새로운 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream) 인스턴스를 반환합니다. 각 인스턴스는 동일한 데이터를 받습니다.

이 메서드를 호출하면 `readableStream.locked`가 `true`로 설정됩니다.


##### `readableStream.values([options])`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamvaluesoptions)

추가된 버전: v16.5.0

-   `options` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `preventCancel` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) `true`로 설정하면, 비동기 이터레이터가 갑자기 종료될 때 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)이 닫히지 않도록 방지합니다. **기본값**: `false`.

이 `ReadableStream`의 데이터를 소비할 수 있는 비동기 이터레이터를 생성하고 반환합니다.

비동기 이터레이터가 활성화된 동안 `readableStream.locked`가 `true`로 설정됩니다.

```js
import { Buffer } from 'node:buffer';
const stream = new ReadableStream(getSomeSource());
for await (const chunk of stream.values({ preventCancel: true })) {
    console.log(Buffer.from(chunk).toString());
}
```


##### 비동기 반복

[`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream) 객체는 `for await` 구문을 사용하여 비동기 반복자 프로토콜을 지원합니다.

```js
import { Buffer } from 'node:buffer';
const stream = new ReadableStream(getSomeSource());
for await (const chunk of stream) {
    console.log(Buffer.from(chunk).toString());
}
```

비동기 반복자는 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)이 종료될 때까지 데이터를 소비합니다.

기본적으로, 비동기 반복자가 `break`, `return`, 또는 `throw`를 통해 조기에 종료되면 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)이 자동으로 닫힙니다. 이 자동 닫힘을 방지하려면 `readableStream.values()` 메서드를 사용하여 비동기 반복자를 얻고, `preventCancel` 옵션을 `true`로 설정하면 됩니다.

[`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)은 잠겨 있지 않아야 합니다(즉, 이미 활성화된 리더가 없어야 함). 비동기 반복 중에는 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)이 잠기게 됩니다.


##### `postMessage()`를 사용한 전송

[`ReadableStream`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream) 인스턴스는 [`MessagePort`](https://nodejs.org/docs/latest/api/worker_threads.html#class-messageport)를 통해 전송할 수 있습니다.

```js
const stream = new ReadableStream(getReadableSourceSomehow());
const { port1, port2 } = new MessageChannel();

port1.onmessage = ({ data }) => {
    data.getReader().read().then((chunk) => {
        console.log(chunk);
    });
};

port2.postMessage(stream, [stream]);
```


#### `ReadableStream.from(iterable)`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamfromiterable)

추가된 버전: v20.6.0

- `iterable` [`<Iterable>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#The_iterable_protocol) `Symbol.asyncIterator` 또는 `Symbol.iterator` 이터러블 프로토콜을 구현한 객체.

이 메서드는 이터러블 객체로부터 새로운 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)을 생성하는 유틸리티입니다.

```javascript
import { ReadableStream } from 'node:stream/web';

async function* asyncIterableGenerator() {
    yield 'a';
    yield 'b';
    yield 'c';
}

const stream = ReadableStream.from(asyncIterableGenerator());

for await (const chunk of stream) {
    console.log(chunk); // 출력: 'a', 'b', 'c'
}
```


#### 클래스: `ReadableStreamDefaultReader`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestreamdefaultreader)

기본적으로 `readableStream.getReader()`를 인자 없이 호출하면 `ReadableStreamDefaultReader`의 인스턴스가 반환됩니다. 이 기본 리더는 스트림을 통해 전달되는 데이터 청크를 불투명한 값으로 처리합니다. 이를 통해 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)은 일반적으로 모든 JavaScript 값과 함께 작동할 수 있습니다.


##### `new ReadableStreamDefaultReader(stream)`[#](https://nodejs.org/docs/latest/api/webstreams.html#new-readablestreamdefaultreaderstream)

추가된 버전: v16.5.0

-   `stream` [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)

주어진 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)에 잠긴 새로운 [`<ReadableStreamDefaultReader>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestreamdefaultreader)를 생성합니다.


##### `readableStreamDefaultReader.cancel([reason])`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamdefaultreadercancelreason)

추가된 버전: v16.5.0

-   `reason` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
-   반환값: `undefined`로 이행되는 Promise

[`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)을 취소하고, 기본 스트림이 취소되었을 때 이행되는 Promise를 반환합니다.


##### `readableStreamDefaultReader.closed`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamdefaultreaderclosed)

추가된 버전: v16.5.0

-   타입: [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)  
  연결된 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)이 닫히면 `undefined`로 이행(fulfilled)됩니다. 스트림이 오류를 발생시키거나 스트림이 완전히 닫히기 전에 리더의 잠금이 해제되면 거부(rejected)됩니다.


##### `readableStreamDefaultReader.read()`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamdefaultreaderread)

추가된 버전: v16.5.0

-   반환값: 다음 속성을 가진 객체로 이행되는 Promise
    -   `value` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
    -   `done` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)

기반이 되는 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)에서 다음 데이터 청크를 요청하고, 데이터가 사용 가능해지면 해당 데이터로 이행되는 Promise를 반환합니다.


##### `readableStreamDefaultReader.releaseLock()`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamdefaultreaderreleaselock)

추가된 버전: v16.5.0

이 메서드는 리더가 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)에 걸어둔 잠금을 해제합니다.


#### 클래스: `ReadableStreamBYOBReader`

`ReadableStreamBYOBReader`는 바이트 지향 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)을 위한 대체 소비자입니다. 이는 `ReadableStream`이 생성될 때 `underlyingSource.type`을 `'bytes'`로 설정하여 생성된 스트림을 대상으로 합니다.

`BYOB`는 "Bring Your Own Buffer"의 약자입니다. 이 패턴은 불필요한 복사를 피하면서 바이트 지향 데이터를 더 효율적으로 읽을 수 있게 해줍니다.

```js
import { open } from 'node:fs/promises';
import { ReadableStream } from 'node:stream/web';
import { Buffer } from 'node:buffer';

class Source {
    type = 'bytes';
    autoAllocateChunkSize = 1024;

    async start(controller) {
        this.file = await open(new URL(import.meta.url));
        this.controller = controller;
    }

    async pull(controller) {
        const view = controller.byobRequest?.view;
        const { bytesRead } = await this.file.read({
            buffer: view,
            offset: view.byteOffset,
            length: view.byteLength,
        });

        if (bytesRead === 0) {
            await this.file.close();
            this.controller.close();
        }
        controller.byobRequest.respond(bytesRead);
    }
}

const stream = new ReadableStream(new Source());

async function read(stream) {
    const reader = stream.getReader({ mode: 'byob' });
    const chunks = [];
    let result;

    do {
        result = await reader.read(Buffer.alloc(100));
        if (result.value !== undefined) chunks.push(Buffer.from(result.value));
    } while (!result.done);

    return Buffer.concat(chunks);
}

const data = await read(stream);
console.log(Buffer.from(data).toString());
```


### `new ReadableStreamBYOBReader(stream)`

**추가된 버전**: v16.5.0

- **`stream`** [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)

주어진 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)에 고정된 새로운 `ReadableStreamBYOBReader`를 생성합니다.


##### `readableStreamBYOBReader.cancel([reason])`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreambyobreadercancelreason)

추가된 버전: v16.5.0

-   `reason` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
-   반환값: `undefined`로 이행되는 Promise

[`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)을 취소하고, 기본 스트림이 취소되었을 때 이행되는 Promise를 반환합니다.


##### `readableStreamBYOBReader.closed`

추가된 버전: v16.5.0

- 타입: [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)  
  연결된 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)이 닫히면 `undefined`로 이행됩니다. 스트림이 오류를 발생시키거나, 스트림이 완전히 닫히기 전에 reader의 잠금이 해제되면 거부됩니다.


##### `readableStreamBYOBReader.read(view[, options])`

- `view` [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer) | [`<TypedArray>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray) | [`<DataView>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView)
- `options` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
  - `min` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) 이 값을 설정하면, `min` 개수 이상의 요소가 사용 가능할 때만 Promise가 이행됩니다. 설정하지 않으면, 최소 하나의 요소가 사용 가능할 때 Promise가 이행됩니다.
- 반환값: 다음 속성을 가진 객체로 이행되는 Promise:
  - `value` [`<TypedArray>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray) | [`<DataView>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView)
  - `done` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)

이 메서드는 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)에서 다음 데이터 청크를 요청하고, 데이터가 사용 가능해지면 해당 데이터로 이행되는 Promise를 반환합니다.

이 메서드에 풀링된 [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer) 객체 인스턴스를 전달하지 마세요. 풀링된 `Buffer` 객체는 `Buffer.allocUnsafe()` 또는 `Buffer.from()`을 사용하여 생성되거나, 다양한 `node:fs` 모듈 콜백에서 반환됩니다. 이러한 유형의 `Buffer`는 모든 풀링된 `Buffer` 인스턴스의 데이터를 포함하는 공유된 [`<ArrayBuffer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer) 객체를 사용합니다. `Buffer`, [`<TypedArray>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray), 또는 [`<DataView>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView)가 `readableStreamBYOBReader.read()`에 전달되면, 해당 뷰의 기반이 되는 `ArrayBuffer`가 *분리*되어 해당 `ArrayBuffer`에 존재할 수 있는 모든 기존 뷰가 무효화됩니다. 이는 애플리케이션에 치명적인 결과를 초래할 수 있습니다.


##### `readableStreamBYOBReader.releaseLock()`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreambyobreaderreleaselock)

추가된 버전: v16.5.0

이 메서드는 현재 리더가 가지고 있는 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)에 대한 잠금을 해제합니다.


#### 클래스: `ReadableStreamDefaultController`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestreamdefaultcontroller)

추가된 버전: v16.5.0

모든 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)은 스트림의 내부 상태와 큐 관리를 담당하는 컨트롤러를 가지고 있습니다. `ReadableStreamDefaultController`는 바이트 지향적이지 않은 `ReadableStream`을 위한 기본 컨트롤러 구현체입니다.


##### `readableStreamDefaultController.close()`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamdefaultcontrollerclose)

추가된 버전: v16.5.0

이 컨트롤러가 연결된 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)을 닫습니다.


##### `readableStreamDefaultController.desiredSize`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamdefaultcontrollerdesiredsize)

추가된 버전: v16.5.0

-   타입: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

[`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)의 큐를 채우기 위해 남아 있는 데이터의 양을 반환합니다.


##### `readableStreamDefaultController.enqueue([chunk])`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamdefaultcontrollerenqueuechunk)

추가된 버전: v16.5.0

-   `chunk` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)

`readableStreamDefaultController.enqueue([chunk])` 메서드는 새로운 데이터 청크를 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)의 큐에 추가합니다. 이 메서드를 사용하면 스트림에 데이터를 계속해서 전달할 수 있습니다.

```javascript
const { ReadableStream } = require('stream/web');

const readableStream = new ReadableStream({
  start(controller) {
    controller.enqueue('첫 번째 청크');
    controller.enqueue('두 번째 청크');
    controller.close();
  }
});

const reader = readableStream.getReader();
reader.read().then(({ value, done }) => {
  if (!done) {
    console.log(value); // '첫 번째 청크' 출력
  }
});
```

위 예제에서 `controller.enqueue()`를 사용하여 스트림에 데이터를 추가하고, `controller.close()`를 호출하여 스트림을 종료합니다. 이후 `reader.read()`를 통해 스트림에서 데이터를 읽어올 수 있습니다.


##### `readableStreamDefaultController.error([error])`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreamdefaultcontrollererrorerror)

추가된 버전: v16.5.0

-   `error` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)

`ReadableStream`에 오류를 발생시키고 스트림을 닫는 신호를 보냅니다. 이 메서드를 호출하면 스트림이 오류 상태로 전환되며, 이후 스트림을 더 이상 사용할 수 없게 됩니다.

```javascript
const { ReadableStream } = require('stream/web');

const stream = new ReadableStream({
  start(controller) {
    // 오류 발생
    controller.error(new Error('스트림 오류 발생'));
  }
});

stream.getReader().read().catch(err => {
  console.error(err); // Error: 스트림 오류 발생
});
```

위 예제에서 `controller.error()`를 호출하면 스트림이 오류 상태로 전환되고, 이후 `read()` 메서드가 오류를 반환합니다.


#### 클래스: `ReadableByteStreamController`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-readablebytestreamcontroller)

모든 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)은 스트림의 내부 상태와 큐 관리를 담당하는 컨트롤러를 가지고 있습니다. `ReadableByteStreamController`는 바이트 지향적인 `ReadableStream`을 위한 컨트롤러입니다.


##### `readableByteStreamController.byobRequest`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablebytestreamcontrollerbyobrequest)

추가된 버전: v16.5.0

-   타입: [`<ReadableStreamBYOBRequest>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestreambyobrequest)


##### `readableByteStreamController.close()`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablebytestreamcontrollerclose)

추가된 버전: v16.5.0

이 컨트롤러가 연결된 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)을 닫습니다.


##### `readableByteStreamController.desiredSize`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablebytestreamcontrollerdesiredsize)

추가된 버전: v16.5.0

-   타입: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

[`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)의 큐를 채우기 위해 남아 있는 데이터의 양을 반환합니다.


##### `readableByteStreamController.enqueue(chunk)`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablebytestreamcontrollerenqueuechunk)

추가된 버전: v16.5.0

-   `chunk`: [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer) | [`<TypedArray>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray) | [`<DataView>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView)

새로운 데이터 청크를 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)의 큐에 추가합니다.


##### `readableByteStreamController.error([error])`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablebytestreamcontrollererrorerror)

추가된 버전: v16.5.0

-   `error` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)

[`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)에 오류를 발생시키고 스트림을 닫는 신호를 보냅니다.


#### 클래스: `ReadableStreamBYOBRequest`

바이트 지향 스트림에서 `ReadableByteStreamController`를 사용하거나 `ReadableStreamBYOBReader`를 사용할 때, `readableByteStreamController.byobRequest` 속성을 통해 현재 읽기 요청을 나타내는 `ReadableStreamBYOBRequest` 인스턴스에 접근할 수 있습니다. 이 객체는 읽기 요청을 위해 제공된 `ArrayBuffer`나 `TypedArray`에 접근하는 데 사용되며, 데이터가 제공되었음을 알리는 메서드를 제공합니다.


##### `readableStreamBYOBRequest.respond(bytesWritten)`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreambyobrequestrespondbyteswritten)

추가된 버전: v16.5.0

-   `bytesWritten` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

`readableStreamBYOBRequest.view`에 `bytesWritten`만큼의 바이트가 쓰여졌음을 알립니다.


##### `readableStreamBYOBRequest.respondWithNewView(view)`[#](https://nodejs.org/docs/latest/api/webstreams.html#readablestreambyobrequestrespondwithnewviewview)

추가된 버전: v16.5.0

-   `view` [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer) | [`<TypedArray>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray) | [`<DataView>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView)

이 메서드는 요청이 새로운 `Buffer`, `TypedArray`, 또는 `DataView`에 바이트가 쓰여짐으로써 완료되었음을 알립니다.


##### `readableStreamBYOBRequest.view`

추가된 버전: v16.5.0

-   타입: [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer) | [`<TypedArray>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray) | [`<DataView>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView)


#### 클래스: `WritableStream`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)

`WritableStream`은 스트림 데이터가 전송되는 목적지입니다.

```js
import { WritableStream } from 'node:stream/web';

const stream = new WritableStream({
    write(chunk) {
        console.log(chunk);
    },
});

await stream.getWriter().write('Hello World');
```


##### `new WritableStream([underlyingSink[, strategy]])`[#](https://nodejs.org/docs/latest/api/webstreams.html#new-writablestreamunderlyingsink-strategy)

추가된 버전: v16.5.0

-   `underlyingSink` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `start` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) `WritableStream`이 생성될 때 즉시 호출되는 사용자 정의 함수.
        -   `controller` [`<WritableStreamDefaultController>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestreamdefaultcontroller)
        -   반환값: `undefined` 또는 `undefined`로 이행된 Promise.
    -   `write` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 데이터 청크가 `WritableStream`에 기록될 때 호출되는 사용자 정의 함수.
        -   `chunk` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
        -   `controller` [`<WritableStreamDefaultController>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestreamdefaultcontroller)
        -   반환값: `undefined`로 이행된 Promise.
    -   `close` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) `WritableStream`이 닫힐 때 호출되는 사용자 정의 함수.
        -   반환값: `undefined`로 이행된 Promise.
    -   `abort` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) `WritableStream`을 급격히 닫기 위해 호출되는 사용자 정의 함수.
        -   `reason` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
        -   반환값: `undefined`로 이행된 Promise.
    -   `type` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types) `type` 옵션은 향후 사용을 위해 예약되어 있으며, 반드시 `undefined`여야 함.
-   `strategy` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `highWaterMark` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) 백프레셔가 적용되기 전의 최대 내부 큐 크기.
    -   `size` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 각 데이터 청크의 크기를 식별하기 위해 사용되는 사용자 정의 함수.
        -   `chunk` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
        -   반환값: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)


##### `writableStream.abort([reason])`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamabortreason)

추가된 버전: v16.5.0

-   `reason` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
-   반환값: `undefined`로 이행되는 Promise

`WritableStream`을 갑자기 종료합니다. 대기 중인 모든 쓰기 작업이 취소되고, 관련된 Promise는 거부됩니다.


##### `writableStream.close()`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamclose)

추가된 버전: v16.5.0

-   반환값: `undefined`로 이행되는 Promise

더 이상 추가적인 쓰기 작업이 예상되지 않을 때 `WritableStream`을 닫습니다.


##### `writableStream.getWriter()`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamgetwriter)

추가된 버전: v16.5.0

-   반환값: [`<WritableStreamDefaultWriter>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestreamdefaultwriter)

`WritableStream`에 데이터를 쓰기 위해 사용할 수 있는 새로운 writer 인스턴스를 생성하고 반환합니다.


##### `writableStream.locked`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamlocked)

추가된 버전: v16.5.0

-   타입: [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)

`writableStream.locked` 속성은 기본적으로 `false`이며, 이 `WritableStream`에 활성화된 writer가 연결되어 있을 때 `true`로 전환됩니다.


##### postMessage()를 사용한 전송

[`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream) 인스턴스는 [`<MessagePort>`](https://nodejs.org/docs/latest/api/worker_threads.html#class-messageport)를 사용해 전송할 수 있습니다.

```js
const stream = new WritableStream(getWritableSinkSomehow());
const { port1, port2 } = new MessageChannel();

port1.onmessage = ({ data }) => {
    data.getWriter().write('hello');
};

port2.postMessage(stream, [stream]);
```


#### Class: `WritableStreamDefaultWriter`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestreamdefaultwriter)





##### `new WritableStreamDefaultWriter(stream)`[#](https://nodejs.org/docs/latest/api/webstreams.html#new-writablestreamdefaultwriterstream)

추가된 버전: v16.5.0

-   `stream` [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)

주어진 `WritableStream`에 고정된 새로운 `WritableStreamDefaultWriter`를 생성합니다.


##### `writableStreamDefaultWriter.abort([reason])`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamdefaultwriterabortreason)

추가된 버전: v16.5.0

-   `reason` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
-   반환값: `undefined`로 이행되는 Promise

`WritableStream`을 급작스럽게 종료합니다. 대기 중인 모든 쓰기 작업이 취소되고, 관련된 Promise는 거부됩니다.


##### `writableStreamDefaultWriter.close()`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamdefaultwriterclose)

추가된 버전: v16.5.0

-   반환값: `undefined`로 이행되는 Promise

더 이상 추가적인 쓰기 작업이 예상되지 않을 때 `WritableStream`을 닫습니다.


##### `writableStreamDefaultWriter.closed`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamdefaultwriterclosed)

추가된 버전: v16.5.0

-   타입: [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)  
    연결된 [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)이 닫히면 `undefined`로 이행(fulfilled)됩니다. 스트림이 오류를 발생시키거나 스트림이 완전히 닫히기 전에 writer의 잠금이 해제되면 거부(rejected)됩니다.


##### `writableStreamDefaultWriter.desiredSize`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamdefaultwriterdesiredsize)

추가된 버전: v16.5.0

-   타입: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

`desiredSize`는 [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)의 큐를 채우기 위해 필요한 데이터의 양을 나타냅니다.


##### `writableStreamDefaultWriter.ready`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamdefaultwriterready)

추가된 버전: v16.5.0

-   타입: [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)  
    writer가 사용 준비가 되면 `undefined`로 이행(fulfilled)됩니다.


##### `writableStreamDefaultWriter.releaseLock()`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamdefaultwriterreleaselock)

추가된 버전: v16.5.0

이 메서드는 현재 작성자가 가지고 있는 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)에 대한 잠금을 해제합니다.


##### `writableStreamDefaultWriter.write([chunk])`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamdefaultwriterwritechunk)

추가된 버전: v16.5.0

-   `chunk`: [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
-   반환값: `undefined`로 이행되는 Promise

[`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)의 큐에 새로운 데이터 청크를 추가합니다.


#### 클래스: `WritableStreamDefaultController`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestreamdefaultcontroller)

`WritableStreamDefaultController`는 [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)의 내부 상태를 관리합니다.


##### `writableStreamDefaultController.error([error])`[#](https://nodejs.org/docs/latest/api/webstreams.html#writablestreamdefaultcontrollererrorerror)

추가된 버전: v16.5.0

-   `error` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)

`WritableStream` 데이터를 처리하는 도중 오류가 발생했음을 알리기 위해 사용자 코드에서 호출합니다. 이 메서드를 호출하면 [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)이 중단되고, 현재 진행 중인 쓰기 작업이 취소됩니다.


### `writableStreamDefaultController.signal`

- **타입**: `<AbortSignal>`  
  `WritableStream`이 중단될 때, 보류 중인 쓰기 또는 닫기 작업을 취소하는 데 사용할 수 있는 `AbortSignal`입니다.


#### 클래스: `TransformStream`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-transformstream)

`TransformStream`은 [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)과 [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)으로 구성됩니다. 이 두 스트림은 연결되어 있어 `WritableStream`에 쓰여진 데이터가 변환될 수 있으며, 변환된 데이터는 `ReadableStream`의 큐로 전달됩니다.

```js
import { TransformStream } from 'node:stream/web';

const transform = new TransformStream({
  transform(chunk, controller) {
    controller.enqueue(chunk.toUpperCase());
  },
});

await Promise.all([
  transform.writable.getWriter().write('A'),
  transform.readable.getReader().read(),
]);
```


##### `new TransformStream([transformer[, writableStrategy[, readableStrategy]]])`[#](https://nodejs.org/docs/latest/api/webstreams.html#new-transformstreamtransformer-writablestrategy-readablestrategy)

추가된 버전: v16.5.0

-   `transformer` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `start` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) `TransformStream`이 생성될 때 즉시 호출되는 사용자 정의 함수.
        -   `controller` [`<TransformStreamDefaultController>`](https://nodejs.org/docs/latest/api/webstreams.html#class-transformstreamdefaultcontroller)
        -   반환값: `undefined` 또는 `undefined`로 이행된 Promise
    -   `transform` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) `transformStream.writable`에 쓰여진 데이터 청크를 받아 수정한 후 `transformStream.readable`로 전달하는 사용자 정의 함수.
        -   `chunk` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
        -   `controller` [`<TransformStreamDefaultController>`](https://nodejs.org/docs/latest/api/webstreams.html#class-transformstreamdefaultcontroller)
        -   반환값: `undefined`로 이행된 Promise
    -   `flush` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) `TransformStream`의 쓰기 가능한 부분이 닫히기 직전에 호출되는 사용자 정의 함수. 변환 프로세스의 종료를 알린다.
        -   `controller` [`<TransformStreamDefaultController>`](https://nodejs.org/docs/latest/api/webstreams.html#class-transformstreamdefaultcontroller)
        -   반환값: `undefined`로 이행된 Promise
    -   `readableType` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types) `readableType` 옵션은 향후 사용을 위해 예약되어 있으며 반드시 `undefined`여야 한다.
    -   `writableType` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types) `writableType` 옵션은 향후 사용을 위해 예약되어 있으며 반드시 `undefined`여야 한다.
-   `writableStrategy` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `highWaterMark` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) 백프레셔가 적용되기 전의 최대 내부 큐 크기.
    -   `size` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 각 데이터 청크의 크기를 식별하는 사용자 정의 함수.
        -   `chunk` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
        -   반환값: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `readableStrategy` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `highWaterMark` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) 백프레셔가 적용되기 전의 최대 내부 큐 크기.
    -   `size` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 각 데이터 청크의 크기를 식별하는 사용자 정의 함수.
        -   `chunk` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
        -   반환값: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)


##### `transformStream.readable`[#](https://nodejs.org/docs/latest/api/webstreams.html#transformstreamreadable)

추가된 버전: v16.5.0

-   타입: [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)


##### `transformStream.writable`[#](https://nodejs.org/docs/latest/api/webstreams.html#transformstreamwritable)

추가된 버전: v16.5.0

-   타입: [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)


##### postMessage()를 사용한 전송

[`<TransformStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-transformstream) 인스턴스는 [`<MessagePort>`](https://nodejs.org/docs/latest/api/worker_threads.html#class-messageport)를 사용해 전송할 수 있습니다.

```js
const stream = new TransformStream();
const { port1, port2 } = new MessageChannel();

port1.onmessage = ({ data }) => {
    const { writable, readable } = data;
    // ...
};

port2.postMessage(stream, [stream]);
```


#### 클래스: `TransformStreamDefaultController`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-transformstreamdefaultcontroller)

`TransformStreamDefaultController`는 `TransformStream`의 내부 상태를 관리합니다.


##### `transformStreamDefaultController.desiredSize`[#](https://nodejs.org/docs/latest/api/webstreams.html#transformstreamdefaultcontrollerdesiredsize)

추가된 버전: v16.5.0

-   타입: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

읽기 가능한 큐를 채우기 위해 필요한 데이터의 양입니다.


##### `transformStreamDefaultController.enqueue([chunk])`[#](https://nodejs.org/docs/latest/api/webstreams.html#transformstreamdefaultcontrollerenqueuechunk)

추가된 버전: v16.5.0

-   `chunk` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)

데이터 청크를 읽기 가능한 측면의 큐에 추가합니다.


##### `transformStreamDefaultController.error([reason])`[#](https://nodejs.org/docs/latest/api/webstreams.html#transformstreamdefaultcontrollererrorreason)

추가된 버전: v16.5.0

-   `reason` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)

변환 데이터를 처리하는 도중 오류가 발생했음을 읽기 가능한 스트림과 쓰기 가능한 스트림 양쪽에 알립니다. 이로 인해 양쪽 스트림이 갑자기 닫힙니다.


##### `transformStreamDefaultController.terminate()`[#](https://nodejs.org/docs/latest/api/webstreams.html#transformstreamdefaultcontrollerterminate)

추가된 버전: v16.5.0

이 메서드는 **읽기 가능한 스트림**을 닫고, **쓰기 가능한 스트림**을 오류와 함께 갑자기 종료시킵니다.


#### Class: `ByteLengthQueuingStrategy`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-bytelengthqueuingstrategy)





##### `new ByteLengthQueuingStrategy(init)`[#](https://nodejs.org/docs/latest/api/webstreams.html#new-bytelengthqueuingstrategyinit)

추가된 버전: v16.5.0

-   `init` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `highWaterMark` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)


##### `byteLengthQueuingStrategy.highWaterMark`[#](https://nodejs.org/docs/latest/api/webstreams.html#bytelengthqueuingstrategyhighwatermark)

추가된 버전: v16.5.0

-   타입: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)


##### `byteLengthQueuingStrategy.size`[#](https://nodejs.org/docs/latest/api/webstreams.html#bytelengthqueuingstrategysize)

추가된 버전: v16.5.0

-   타입: [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function)
    -   `chunk` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
    -   반환값: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)


#### Class: `CountQueuingStrategy`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-countqueuingstrategy)





### `new CountQueuingStrategy(init)`

**추가된 버전:** v16.5.0

- `init` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
  - `highWaterMark` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

이 생성자는 `CountQueuingStrategy` 객체를 생성합니다. `init` 객체는 `highWaterMark` 속성을 포함해야 합니다. `highWaterMark`는 큐의 최대 크기를 나타내는 숫자 값입니다. 이 값은 큐가 얼마나 많은 항목을 보관할 수 있는지를 결정합니다.


##### `countQueuingStrategy.highWaterMark`

추가된 버전: v16.5.0

-   타입: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)


##### `countQueuingStrategy.size`[#](https://nodejs.org/docs/latest/api/webstreams.html#countqueuingstrategysize)

추가된 버전: v16.5.0

-   타입: [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function)
    -   `chunk` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
    -   반환값: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)


#### Class: `TextEncoderStream`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-textencoderstream)





##### `new TextEncoderStream()`[#](https://nodejs.org/docs/latest/api/webstreams.html#new-textencoderstream)

추가된 버전: v16.6.0

새로운 `TextEncoderStream` 인스턴스를 생성합니다.


##### `textEncoderStream.encoding`[#](https://nodejs.org/docs/latest/api/webstreams.html#textencoderstreamencoding)

추가된 버전: v16.6.0

-   타입: [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type)

`TextEncoderStream` 인스턴스가 지원하는 인코딩 방식입니다.


##### `textEncoderStream.readable`

추가된 버전: v16.6.0

-   타입: [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)


##### `textEncoderStream.writable`

추가된 버전: v16.6.0

-   타입: [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)


#### Class: `TextDecoderStream`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-textdecoderstream)





##### `new TextDecoderStream([encoding[, options]])`[#](https://nodejs.org/docs/latest/api/webstreams.html#new-textdecoderstreamencoding-options)

추가된 버전: v16.6.0

-   `encoding` [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) 이 `TextDecoder` 인스턴스가 지원하는 `encoding`을 지정합니다. **기본값:** `'utf-8'`.
-   `options` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `fatal` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) 디코딩 실패가 치명적인 경우 `true`로 설정합니다.
    -   `ignoreBOM` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) `true`로 설정하면 `TextDecoderStream`이 디코딩 결과에 바이트 순서 표시(BOM)를 포함합니다. `false`로 설정하면 출력에서 바이트 순서 표시를 제거합니다. 이 옵션은 `encoding`이 `'utf-8'`, `'utf-16be'`, 또는 `'utf-16le'`일 때만 사용됩니다. **기본값:** `false`.

새로운 `TextDecoderStream` 인스턴스를 생성합니다.


##### `textDecoderStream.encoding`[#](https://nodejs.org/docs/latest/api/webstreams.html#textdecoderstreamencoding)

추가된 버전: v16.6.0

-   타입: [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type)

`TextDecoderStream` 인스턴스가 지원하는 인코딩 방식입니다.


##### `textDecoderStream.fatal`[#](https://nodejs.org/docs/latest/api/webstreams.html#textdecoderstreamfatal)

추가된 버전: v16.6.0

-   타입: [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)

이 값은 디코딩 오류가 발생했을 때 `TypeError`가 발생하는 경우 `true`가 됩니다.


##### `textDecoderStream.ignoreBOM`[#](https://nodejs.org/docs/latest/api/webstreams.html#textdecoderstreamignorebom)

추가된 버전: v16.6.0

-   타입: [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)

이 값은 디코딩 결과에 바이트 순서 표시(BOM)가 포함될 경우 `true`가 됩니다.


##### `textDecoderStream.readable`[#](https://nodejs.org/docs/latest/api/webstreams.html#textdecoderstreamreadable)

추가된 버전: v16.6.0

-   타입: [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)


##### `textDecoderStream.writable`[#](https://nodejs.org/docs/latest/api/webstreams.html#textdecoderstreamwritable)

추가된 버전: v16.6.0

-   타입: [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)


#### Class: `CompressionStream`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-compressionstream)





##### `new CompressionStream(format)`

- `format` [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) `'deflate'`, `'deflate-raw'`, 또는 `'gzip'` 중 하나입니다.


##### `compressionStream.readable`[#](https://nodejs.org/docs/latest/api/webstreams.html#compressionstreamreadable)

추가된 버전: v17.0.0

-   타입: [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)


##### `compressionStream.writable`[#](https://nodejs.org/docs/latest/api/webstreams.html#compressionstreamwritable)

추가된 버전: v17.0.0

-   타입: [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)


#### Class: `DecompressionStream`[#](https://nodejs.org/docs/latest/api/webstreams.html#class-decompressionstream)





```javascript
new DecompressionStream(format)
```

- `format` [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type)  
  `'deflate'`, `'deflate-raw'`, 또는 `'gzip'` 중 하나를 선택할 수 있습니다.


##### `decompressionStream.readable`[#](https://nodejs.org/docs/latest/api/webstreams.html#decompressionstreamreadable)

추가된 버전: v17.0.0

-   타입: [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream)


##### `decompressionStream.writable`[#](https://nodejs.org/docs/latest/api/webstreams.html#decompressionstreamwritable)

추가된 버전: v17.0.0

-   타입: [`<WritableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-writablestream)


#### 유틸리티 컨슈머[#](https://nodejs.org/docs/latest/api/webstreams.html#utility-consumers)

추가된 버전: v16.7.0

유틸리티 컨슈머 함수는 스트림을 소비하기 위한 일반적인 옵션을 제공합니다.

이 함수들은 다음과 같이 접근할 수 있습니다:

```js
import { arrayBuffer, blob, buffer, json, text, } from 'node:stream/consumers';
```


##### `streamConsumers.arrayBuffer(stream)`[#](https://nodejs.org/docs/latest/api/webstreams.html#streamconsumersarraybufferstream)

추가된 버전: v16.7.0

-   `stream` [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream) | [`<stream.Readable>`](https://nodejs.org/docs/latest/api/stream.html#class-streamreadable) | [`<AsyncIterator>`](https://tc39.github.io/ecma262/#sec-asynciterator-interface)
-   반환값: [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) 스트림의 전체 내용을 담은 `ArrayBuffer`로 이행됩니다.

```js
import { arrayBuffer } from 'node:stream/consumers';
import { Readable } from 'node:stream';
import { TextEncoder } from 'node:util';

const encoder = new TextEncoder();
const dataArray = encoder.encode('hello world from consumers!');
const readable = Readable.from(dataArray);
const data = await arrayBuffer(readable);

console.log(`from readable: ${data.byteLength}`); // 출력: from readable: 76
```


##### `streamConsumers.blob(stream)`[#](https://nodejs.org/docs/latest/api/webstreams.html#streamconsumersblobstream)

추가된 버전: v16.7.0

-   `stream` [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream) | [`<stream.Readable>`](https://nodejs.org/docs/latest/api/stream.html#class-streamreadable) | [`<AsyncIterator>`](https://tc39.github.io/ecma262/#sec-asynciterator-interface)
-   반환값: [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) 스트림의 전체 내용을 포함한 [`<Blob>`](https://nodejs.org/docs/latest/api/buffer.html#class-blob)으로 이행됩니다.

```js
import { blob } from 'node:stream/consumers';
const dataBlob = new Blob(['hello world from consumers!']);
const readable = dataBlob.stream();
const data = await blob(readable);
console.log(`from readable: ${data.size}`); // 출력: from readable: 27
```


##### `streamConsumers.buffer(stream)`[#](https://nodejs.org/docs/latest/api/webstreams.html#streamconsumersbufferstream)

추가된 버전: v16.7.0

-   `stream` [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream) | [`<stream.Readable>`](https://nodejs.org/docs/latest/api/stream.html#class-streamreadable) | [`<AsyncIterator>`](https://tc39.github.io/ecma262/#sec-asynciterator-interface)
-   반환값: [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) 스트림의 전체 내용을 담은 [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer)로 이행됩니다.

```js
import { buffer } from 'node:stream/consumers';
import { Readable } from 'node:stream';
import { Buffer } from 'node:buffer';

const dataBuffer = Buffer.from('hello world from consumers!');
const readable = Readable.from(dataBuffer);
const data = await buffer(readable);

console.log(`from readable: ${data.length}`); // 출력: from readable: 27
```


##### `streamConsumers.json(stream)`[#](https://nodejs.org/docs/latest/api/webstreams.html#streamconsumersjsonstream)

추가된 버전: v16.7.0

-   `stream` [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream) | [`<stream.Readable>`](https://nodejs.org/docs/latest/api/stream.html#class-streamreadable) | [`<AsyncIterator>`](https://tc39.github.io/ecma262/#sec-asynciterator-interface)
-   반환값: [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) 스트림의 내용을 UTF-8로 인코딩된 문자열로 파싱한 후, `JSON.parse()`를 통해 파싱된 결과를 반환합니다.

```js
import { json } from 'node:stream/consumers';
import { Readable } from 'node:stream';

const items = Array.from(
  { length: 100 },
  () => ({ message: 'hello world from consumers!' })
);

const readable = Readable.from(JSON.stringify(items));
const data = await json(readable);

console.log(`from readable: ${data.length}`); // 출력: from readable: 100
```


##### `streamConsumers.text(stream)`[#](https://nodejs.org/docs/latest/api/webstreams.html#streamconsumerstextstream)

추가된 버전: v16.7.0

-   `stream` [`<ReadableStream>`](https://nodejs.org/docs/latest/api/webstreams.html#class-readablestream) | [`<stream.Readable>`](https://nodejs.org/docs/latest/api/stream.html#class-streamreadable) | [`<AsyncIterator>`](https://tc39.github.io/ecma262/#sec-asynciterator-interface)
-   반환값: [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) 스트림의 내용을 UTF-8로 인코딩된 문자열로 파싱하여 반환한다.

```js
import { text } from 'node:stream/consumers';
import { Readable } from 'node:stream';

const readable = Readable.from('Hello world from consumers!');
const data = await text(readable);
console.log(`from readable: ${data.length}`); // 출력: from readable: 27
```


