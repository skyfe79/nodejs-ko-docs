# Table of Contents

- [V8](#v8)
    - [`v8.cachedDataVersionTag()`[#](https://nodejs.org/docs/latest/api/v8.html#v8cacheddataversiontag)](#v8cacheddataversiontaghttpsnodejsorgdocslatestapiv8htmlv8cacheddataversiontag)
    - [`v8.getHeapCodeStatistics()`[#](https://nodejs.org/docs/latest/api/v8.html#v8getheapcodestatistics)](#v8getheapcodestatisticshttpsnodejsorgdocslatestapiv8htmlv8getheapcodestatistics)
    - [`v8.getHeapSnapshot([options])`](#v8getheapsnapshotoptions)
    - [`v8.getHeapSpaceStatistics()`[#](https://nodejs.org/docs/latest/api/v8.html#v8getheapspacestatistics)](#v8getheapspacestatisticshttpsnodejsorgdocslatestapiv8htmlv8getheapspacestatistics)
    - [`v8.getHeapStatistics()`[#](https://nodejs.org/docs/latest/api/v8.html#v8getheapstatistics)](#v8getheapstatisticshttpsnodejsorgdocslatestapiv8htmlv8getheapstatistics)
    - [`v8.queryObjects(ctor[, options])`[#](https://nodejs.org/docs/latest/api/v8.html#v8queryobjectsctor-options)](#v8queryobjectsctor-optionshttpsnodejsorgdocslatestapiv8htmlv8queryobjectsctor-options)
    - [`v8.setFlagsFromString(flags)`[#](https://nodejs.org/docs/latest/api/v8.html#v8setflagsfromstringflags)](#v8setflagsfromstringflagshttpsnodejsorgdocslatestapiv8htmlv8setflagsfromstringflags)
    - [`v8.stopCoverage()`[#](https://nodejs.org/docs/latest/api/v8.html#v8stopcoverage)](#v8stopcoveragehttpsnodejsorgdocslatestapiv8htmlv8stopcoverage)
    - [`v8.takeCoverage()`[#](https://nodejs.org/docs/latest/api/v8.html#v8takecoverage)](#v8takecoveragehttpsnodejsorgdocslatestapiv8htmlv8takecoverage)
    - [`v8.writeHeapSnapshot([filename[, options]])`](#v8writeheapsnapshotfilename-options)
    - [`v8.setHeapSnapshotNearHeapLimit(limit)`[#](https://nodejs.org/docs/latest/api/v8.html#v8setheapsnapshotnearheaplimitlimit)](#v8setheapsnapshotnearheaplimitlimithttpsnodejsorgdocslatestapiv8htmlv8setheapsnapshotnearheaplimitlimit)
    - [직렬화 API[#](https://nodejs.org/docs/latest/api/v8.html#serialization-api)](#직렬화-apihttpsnodejsorgdocslatestapiv8htmlserialization-api)
      - [`v8.serialize(value)`[#](https://nodejs.org/docs/latest/api/v8.html#v8serializevalue)](#v8serializevaluehttpsnodejsorgdocslatestapiv8htmlv8serializevalue)
      - [`v8.deserialize(buffer)`[#](https://nodejs.org/docs/latest/api/v8.html#v8deserializebuffer)](#v8deserializebufferhttpsnodejsorgdocslatestapiv8htmlv8deserializebuffer)
      - [클래스: `v8.Serializer`[#](https://nodejs.org/docs/latest/api/v8.html#class-v8serializer)](#클래스-v8serializerhttpsnodejsorgdocslatestapiv8htmlclass-v8serializer)
        - [`new Serializer()`[#](https://nodejs.org/docs/latest/api/v8.html#new-serializer)](#new-serializerhttpsnodejsorgdocslatestapiv8htmlnew-serializer)
        - [`serializer.writeHeader()`[#](https://nodejs.org/docs/latest/api/v8.html#serializerwriteheader)](#serializerwriteheaderhttpsnodejsorgdocslatestapiv8htmlserializerwriteheader)
        - [`serializer.writeValue(value)`[#](https://nodejs.org/docs/latest/api/v8.html#serializerwritevaluevalue)](#serializerwritevaluevaluehttpsnodejsorgdocslatestapiv8htmlserializerwritevaluevalue)
        - [`serializer.releaseBuffer()`[#](https://nodejs.org/docs/latest/api/v8.html#serializerreleasebuffer)](#serializerreleasebufferhttpsnodejsorgdocslatestapiv8htmlserializerreleasebuffer)
    - [`serializer.transferArrayBuffer(id, arrayBuffer)`](#serializertransferarraybufferid-arraybuffer)
    - [`serializer.writeUint32(value)`](#serializerwriteuint32value)
    - [`serializer.writeUint64(hi, lo)`](#serializerwriteuint64hi-lo)
    - [`serializer.writeDouble(value)`](#serializerwritedoublevalue)
    - [`serializer.writeRawBytes(buffer)`](#serializerwriterawbytesbuffer)
        - [`serializer._writeHostObject(object)`[#](https://nodejs.org/docs/latest/api/v8.html#serializer_writehostobjectobject)](#serializer_writehostobjectobjecthttpsnodejsorgdocslatestapiv8htmlserializer_writehostobjectobject)
        - [`serializer._getDataCloneError(message)`](#serializer_getdatacloneerrormessage)
      - [클래스: `v8.Deserializer`[#](https://nodejs.org/docs/latest/api/v8.html#class-v8deserializer)](#클래스-v8deserializerhttpsnodejsorgdocslatestapiv8htmlclass-v8deserializer)
        - [`new Deserializer(buffer)`[#](https://nodejs.org/docs/latest/api/v8.html#new-deserializerbuffer)](#new-deserializerbufferhttpsnodejsorgdocslatestapiv8htmlnew-deserializerbuffer)
        - [`deserializer.readHeader()`[#](https://nodejs.org/docs/latest/api/v8.html#deserializerreadheader)](#deserializerreadheaderhttpsnodejsorgdocslatestapiv8htmldeserializerreadheader)
    - [`deserializer.transferArrayBuffer(id, arrayBuffer)`](#deserializertransferarraybufferid-arraybuffer)
    - [`deserializer.getWireFormatVersion()`](#deserializergetwireformatversion)
    - [`deserializer.readUint32()`[#](https://nodejs.org/docs/latest/api/v8.html#deserializerreaduint32)](#deserializerreaduint32httpsnodejsorgdocslatestapiv8htmldeserializerreaduint32)
    - [`deserializer.readUint64()`](#deserializerreaduint64)
    - [`deserializer.readDouble()`](#deserializerreaddouble)
    - [`deserializer.readRawBytes(length)`](#deserializerreadrawbyteslength)
    - [`deserializer._readHostObject()`[#](https://nodejs.org/docs/latest/api/v8.html#deserializer_readhostobject)](#deserializer_readhostobjecthttpsnodejsorgdocslatestapiv8htmldeserializer_readhostobject)
      - [클래스: `v8.DefaultSerializer`[#](https://nodejs.org/docs/latest/api/v8.html#class-v8defaultserializer)](#클래스-v8defaultserializerhttpsnodejsorgdocslatestapiv8htmlclass-v8defaultserializer)
      - [클래스: `v8.DefaultDeserializer`[#](https://nodejs.org/docs/latest/api/v8.html#class-v8defaultdeserializer)](#클래스-v8defaultdeserializerhttpsnodejsorgdocslatestapiv8htmlclass-v8defaultdeserializer)
    - [Promise hooks[#](https://nodejs.org/docs/latest/api/v8.html#promise-hooks)](#promise-hookshttpsnodejsorgdocslatestapiv8htmlpromise-hooks)
      - [`promiseHooks.onInit(init)`[#](https://nodejs.org/docs/latest/api/v8.html#promisehooksoninitinit)](#promisehooksoninitinithttpsnodejsorgdocslatestapiv8htmlpromisehooksoninitinit)
      - [`promiseHooks.onSettled(settled)`[#](https://nodejs.org/docs/latest/api/v8.html#promisehooksonsettledsettled)](#promisehooksonsettledsettledhttpsnodejsorgdocslatestapiv8htmlpromisehooksonsettledsettled)
      - [`promiseHooks.onBefore(before)`[#](https://nodejs.org/docs/latest/api/v8.html#promisehooksonbeforebefore)](#promisehooksonbeforebeforehttpsnodejsorgdocslatestapiv8htmlpromisehooksonbeforebefore)
      - [`promiseHooks.onAfter(after)`[#](https://nodejs.org/docs/latest/api/v8.html#promisehooksonafterafter)](#promisehooksonafterafterhttpsnodejsorgdocslatestapiv8htmlpromisehooksonafterafter)
      - [`promiseHooks.createHook(callbacks)`[#](https://nodejs.org/docs/latest/api/v8.html#promisehookscreatehookcallbacks)](#promisehookscreatehookcallbackshttpsnodejsorgdocslatestapiv8htmlpromisehookscreatehookcallbacks)
      - [훅 콜백](#훅-콜백)
    - [`init(promise, parent)`](#initpromise-parent)
        - [`before(promise)`[#](https://nodejs.org/docs/latest/api/v8.html#beforepromise)](#beforepromisehttpsnodejsorgdocslatestapiv8htmlbeforepromise)
        - [`after(promise)`[#](https://nodejs.org/docs/latest/api/v8.html#afterpromise)](#afterpromisehttpsnodejsorgdocslatestapiv8htmlafterpromise)
        - [`settled(promise)`[#](https://nodejs.org/docs/latest/api/v8.html#settledpromise)](#settledpromisehttpsnodejsorgdocslatestapiv8htmlsettledpromise)
    - [Startup Snapshot API[#](https://nodejs.org/docs/latest/api/v8.html#startup-snapshot-api)](#startup-snapshot-apihttpsnodejsorgdocslatestapiv8htmlstartup-snapshot-api)
      - [`v8.startupSnapshot.addSerializeCallback(callback[, data])`[#](https://nodejs.org/docs/latest/api/v8.html#v8startupsnapshotaddserializecallbackcallback-data)](#v8startupsnapshotaddserializecallbackcallback-datahttpsnodejsorgdocslatestapiv8htmlv8startupsnapshotaddserializecallbackcallback-data)
      - [`v8.startupSnapshot.addDeserializeCallback(callback[, data])`[#](https://nodejs.org/docs/latest/api/v8.html#v8startupsnapshotadddeserializecallbackcallback-data)](#v8startupsnapshotadddeserializecallbackcallback-datahttpsnodejsorgdocslatestapiv8htmlv8startupsnapshotadddeserializecallbackcallback-data)
      - [`v8.startupSnapshot.setDeserializeMainFunction(callback[, data])`[#](https://nodejs.org/docs/latest/api/v8.html#v8startupsnapshotsetdeserializemainfunctioncallback-data)](#v8startupsnapshotsetdeserializemainfunctioncallback-datahttpsnodejsorgdocslatestapiv8htmlv8startupsnapshotsetdeserializemainfunctioncallback-data)
      - [`v8.startupSnapshot.isBuildingSnapshot()`[#](https://nodejs.org/docs/latest/api/v8.html#v8startupsnapshotisbuildingsnapshot)](#v8startupsnapshotisbuildingsnapshothttpsnodejsorgdocslatestapiv8htmlv8startupsnapshotisbuildingsnapshot)
    - [클래스: `v8.GCProfiler`[#](https://nodejs.org/docs/latest/api/v8.html#class-v8gcprofiler)](#클래스-v8gcprofilerhttpsnodejsorgdocslatestapiv8htmlclass-v8gcprofiler)
      - [`new v8.GCProfiler()`[#](https://nodejs.org/docs/latest/api/v8.html#new-v8gcprofiler)](#new-v8gcprofilerhttpsnodejsorgdocslatestapiv8htmlnew-v8gcprofiler)
      - [`profiler.start()`[#](https://nodejs.org/docs/latest/api/v8.html#profilerstart)](#profilerstarthttpsnodejsorgdocslatestapiv8htmlprofilerstart)
      - [`profiler.stop()`[#](https://nodejs.org/docs/latest/api/v8.html#profilerstop)](#profilerstophttpsnodejsorgdocslatestapiv8htmlprofilerstop)

# V8

**소스 코드:** [lib/v8.js](https://github.com/nodejs/node/blob/v23.5.0/lib/v8.js)

`node:v8` 모듈은 Node.js 바이너리에 내장된 [V8](https://developers.google.com/v8/) 버전과 관련된 API를 제공합니다. 이 모듈은 다음과 같이 사용할 수 있습니다:

```js
const v8 = require('node:v8');
```


### `v8.cachedDataVersionTag()`[#](https://nodejs.org/docs/latest/api/v8.html#v8cacheddataversiontag)

추가된 버전: v8.0.0

-   반환값: [`<integer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

이 함수는 V8 버전, 커맨드라인 플래그, 그리고 감지된 CPU 기능으로부터 파생된 버전 태그를 나타내는 정수를 반환합니다. 이 값은 [`vm.Script`](https://nodejs.org/docs/latest/api/vm.html#new-vmscriptcode-options)의 `cachedData` 버퍼가 현재 V8 인스턴스와 호환되는지 확인하는 데 유용합니다.

```js
console.log(v8.cachedDataVersionTag()); // 3947234607
// v8.cachedDataVersionTag()가 반환하는 값은 V8 버전, 커맨드라인 플래그, 그리고 감지된 CPU 기능으로부터 파생됩니다.
// 플래그가 변경될 때 값이 실제로 업데이트되는지 테스트해 보세요.
v8.setFlagsFromString('--allow_natives_syntax');
console.log(v8.cachedDataVersionTag()); // 183726201
```


### `v8.getHeapCodeStatistics()`[#](https://nodejs.org/docs/latest/api/v8.html#v8getheapcodestatistics)

추가된 버전: v12.8.0

-   반환값: [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

힙(heap)에 있는 코드와 메타데이터에 대한 통계를 가져옵니다. V8의 [`GetHeapCodeAndMetadataStatistics`](https://v8docs.nodesource.com/node-13.2/d5/dda/classv8_1_1_isolate.html#a6079122af17612ef54ef3348ce170866) API를 참고하세요. 이 함수는 다음과 같은 속성을 가진 객체를 반환합니다:

-   `code_and_metadata_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `bytecode_and_metadata_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `external_script_source_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `cpu_profiler_metadata_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

```js
{
    code_and_metadata_size: 212208,
    bytecode_and_metadata_size: 161368,
    external_script_source_size: 1410794,
    cpu_profiler_metadata_size: 0,
}
```


### `v8.getHeapSnapshot([options])`

- `options` [`<Object>`]
  - `exposeInternals` [`<boolean>`]  
    내부 구조를 힙 스냅샷에 포함할지 여부를 결정합니다. **기본값:** `false`.
  - `exposeNumericValues` [`<boolean>`]  
    숫자 값을 인공 필드에 포함할지 여부를 결정합니다. **기본값:** `false`.
- 반환값: [`<stream.Readable>`]  
  V8 힙 스냅샷을 포함하는 Readable 스트림을 반환합니다.

현재 V8 힙의 스냅샷을 생성하고, JSON으로 직렬화된 표현을 읽을 수 있는 Readable 스트림을 반환합니다. 이 JSON 스트림 형식은 Chrome DevTools와 같은 도구에서 사용하기 위해 설계되었습니다. JSON 스키마는 문서화되어 있지 않으며 V8 엔진에 특화되어 있습니다. 따라서 스키마는 V8 버전에 따라 변경될 수 있습니다.

힙 스냅샷을 생성하려면 스냅샷 생성 시점의 힙 크기보다 약 두 배 정도의 메모리가 필요합니다. 이로 인해 OOM 킬러가 프로세스를 종료할 위험이 있습니다.

스냅샷 생성은 동기 작업으로, 힙 크기에 따라 이벤트 루프가 일정 시간 동안 차단됩니다.

```js
// 힙 스냅샷을 콘솔에 출력
const v8 = require('node:v8');
const stream = v8.getHeapSnapshot();
stream.pipe(process.stdout);
```


### `v8.getHeapSpaceStatistics()`[#](https://nodejs.org/docs/latest/api/v8.html#v8getheapspacestatistics)

-   반환값: [`<Object\[\]>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

V8 힙 공간에 대한 통계를 반환합니다. V8 힙을 구성하는 세그먼트에 대한 정보를 제공합니다. 힙 공간의 순서나 특정 힙 공간의 사용 가능 여부는 보장되지 않습니다. 이 통계는 V8의 [`GetHeapSpaceStatistics`](https://v8docs.nodesource.com/node-13.2/d5/dda/classv8_1_1_isolate.html#ac673576f24fdc7a33378f8f57e1d13a4) 함수를 통해 제공되며, V8 버전에 따라 변경될 수 있습니다.

반환된 값은 다음과 같은 속성을 가진 객체의 배열입니다:

-   `space_name` [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type)
-   `space_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `space_used_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `space_available_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `physical_space_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

```json
[
    {
        "space_name": "new_space",
        "space_size": 2063872,
        "space_used_size": 951112,
        "space_available_size": 80824,
        "physical_space_size": 2063872
    },
    {
        "space_name": "old_space",
        "space_size": 3090560,
        "space_used_size": 2493792,
        "space_available_size": 0,
        "physical_space_size": 3090560
    },
    {
        "space_name": "code_space",
        "space_size": 1260160,
        "space_used_size": 644256,
        "space_available_size": 960,
        "physical_space_size": 1260160
    },
    {
        "space_name": "map_space",
        "space_size": 1094160,
        "space_used_size": 201608,
        "space_available_size": 0,
        "physical_space_size": 1094160
    },
    {
        "space_name": "large_object_space",
        "space_size": 0,
        "space_used_size": 0,
        "space_available_size": 1490980608,
        "physical_space_size": 0
    }
]
```


### `v8.getHeapStatistics()`[#](https://nodejs.org/docs/latest/api/v8.html#v8getheapstatistics)

-   반환값: [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

다음 속성을 가진 객체를 반환합니다:

-   `total_heap_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `total_heap_size_executable` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `total_physical_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `total_available_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `used_heap_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `heap_size_limit` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `malloced_memory` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `peak_malloced_memory` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `does_zap_garbage` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `number_of_native_contexts` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `number_of_detached_contexts` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `total_global_handles_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `used_global_handles_size` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
-   `external_memory` [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

`total_heap_size`는 V8이 힙에 할당한 총 바이트 수입니다. `used_heap`이 더 많은 메모리를 필요로 하면 이 값이 증가할 수 있습니다.

`total_heap_size_executable`은 실행 가능한 코드를 포함할 수 있는 힙의 일부를 바이트 단위로 나타냅니다. 이는 JIT 컴파일된 코드와 실행 가능한 상태로 유지되어야 하는 메모리를 포함합니다.

`total_physical_size`는 V8 힙이 실제로 사용하는 물리적 메모리의 크기를 바이트 단위로 나타냅니다. 이는 예약된 메모리가 아닌 실제로 사용 중인 메모리의 양입니다.

`total_available_size`는 V8 힙이 사용할 수 있는 메모리의 바이트 수입니다. 이 값은 V8이 힙 제한을 초과하기 전에 사용할 수 있는 메모리의 양을 나타냅니다.

`used_heap_size`는 V8의 자바스크립트 객체가 현재 사용 중인 메모리의 바이트 수입니다. 이는 실제로 사용 중인 메모리를 나타내며, 할당되었지만 아직 사용되지 않은 메모리는 포함하지 않습니다.

`heap_size_limit`은 V8 힙의 최대 크기를 바이트 단위로 나타냅니다. 이 값은 시스템 리소스에 의해 결정된 기본 제한이거나 `--max_old_space_size` 옵션으로 전달된 값입니다.

`malloced_memory`는 V8이 `malloc`을 통해 할당한 메모리의 바이트 수입니다.

`peak_malloced_memory`는 프로세스의 수명 동안 V8이 `malloc`을 통해 할당한 메모리의 최대 바이트 수입니다.

`does_zap_garbage`는 0 또는 1의 불리언 값으로, `--zap_code_space` 옵션이 활성화되었는지 여부를 나타냅니다. 이 옵션은 V8이 힙의 쓰레기를 비트 패턴으로 덮어쓰게 합니다. RSS(Resident Set Size)가 커지는 이유는 모든 힙 페이지를 지속적으로 접근하기 때문에 운영체제가 이를 스왑 아웃할 가능성이 줄어들기 때문입니다.

`number_of_native_contexts`는 현재 활성화된 최상위 컨텍스트의 수입니다. 이 값이 시간이 지남에 따라 증가하면 메모리 누수가 발생할 가능성이 있습니다.

`number_of_detached_contexts`는 분리되었지만 아직 가비지 컬렉션되지 않은 컨텍스트의 수입니다. 이 값이 0이 아니면 메모리 누수가 발생할 가능성이 있습니다.

`total_global_handles_size`는 V8 전역 핸들의 총 메모리 크기입니다.

`used_global_handles_size`는 V8 전역 핸들이 사용 중인 메모리 크기입니다.

`external_memory`는 배열 버퍼와 외부 문자열의 메모리 크기입니다.

```js
{ 
  total_heap_size: 7326976, 
  total_heap_size_executable: 4194304, 
  total_physical_size: 7326976, 
  total_available_size: 1152656, 
  used_heap_size: 3476208, 
  heap_size_limit: 1535115264, 
  malloced_memory: 16384, 
  peak_malloced_memory: 1127496, 
  does_zap_garbage: 0, 
  number_of_native_contexts: 1, 
  number_of_detached_contexts: 0, 
  total_global_handles_size: 8192, 
  used_global_handles_size: 3296, 
  external_memory: 318824 
}
```


### `v8.queryObjects(ctor[, options])`[#](https://nodejs.org/docs/latest/api/v8.html#v8queryobjectsctor-options)

추가된 버전: v22.0.0, v20.13.0

-   `ctor` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 프로토타입 체인을 검색하여 힙(heap)에서 대상 객체를 필터링하는 데 사용할 생성자 함수.
-   `options` [`<undefined>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Undefined_type) | [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
    -   `format` [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) `'count'`로 설정하면 일치하는 객체의 수를 반환. `'summary'`로 설정하면 일치하는 객체의 요약 문자열 배열을 반환.
-   반환값: {number|Array}

이 API는 Chromium DevTools 콘솔에서 제공하는 [`queryObjects()` 콘솔 API](https://developer.chrome.com/docs/devtools/console/utilities#queryObjects-function)와 유사합니다. 이 API는 가비지 컬렉션이 완료된 후 힙에서 프로토타입 체인에 일치하는 생성자를 가진 객체를 검색하는 데 사용할 수 있으며, 메모리 누수 회귀 테스트에 유용합니다. 예상치 못한 결과를 피하기 위해, 여러분이 제어하지 않는 생성자나 애플리케이션 내에서 다른 당사자가 호출할 수 있는 생성자에 이 API를 사용하지 않는 것이 좋습니다.

우발적인 누수를 방지하기 위해, 이 API는 발견된 객체에 대한 원시 참조를 반환하지 않습니다. 기본적으로 발견된 객체의 수를 반환합니다. `options.format`이 `'summary'`로 설정된 경우, 각 객체에 대한 간단한 문자열 표현을 포함한 배열을 반환합니다. 이 API에서 제공하는 가시성은 힙 스냅샷과 유사하지만, 직렬화와 파싱 비용을 절약하고 검색 중에 직접 대상 객체를 필터링할 수 있습니다.

결과에는 현재 실행 컨텍스트에서 생성된 객체만 포함됩니다.

```js
import { queryObjects } from 'node:v8';

class A {
    foo = 'bar';
}

console.log(queryObjects(A)); // 0

const a = new A();
console.log(queryObjects(A)); // 1
// [ "A { foo: 'bar' }" ]
console.log(queryObjects(A, { format: 'summary' }));

class B extends A {
    bar = 'qux';
}

const b = new B();
console.log(queryObjects(B)); // 1
// [ "B { foo: 'bar', bar: 'qux' }" ]
console.log(queryObjects(B, { format: 'summary' }));

// 주의: 자식 클래스가 생성자를 상속하는 경우,
// 생성자는 자식 클래스의 프로토타입 체인에도 나타나므로
// 자식 클래스의 프로토타입도 결과에 포함됩니다.
console.log(queryObjects(A)); // 3
// [ "B { foo: 'bar', bar: 'qux' }", 'A {}', "A { foo: 'bar' }" ]
console.log(queryObjects(A, { format: 'summary' }));
```


### `v8.setFlagsFromString(flags)`[#](https://nodejs.org/docs/latest/api/v8.html#v8setflagsfromstringflags)

추가된 버전: v1.0.0

-   `flags` [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type)

`v8.setFlagsFromString()` 메서드는 V8 커맨드라인 플래그를 프로그래밍 방식으로 설정할 때 사용됩니다. 이 메서드는 주의해서 사용해야 합니다. VM이 시작된 후 설정을 변경하면 예측할 수 없는 동작이 발생할 수 있습니다. 이는 크래시나 데이터 손실을 초래할 수도 있고, 아무런 효과가 없을 수도 있습니다.

Node.js 버전에서 사용 가능한 V8 옵션은 `node --v8-options` 명령을 실행하여 확인할 수 있습니다.

사용 예제:

```js
// 1분 동안 GC 이벤트를 stdout에 출력합니다.
const v8 = require('node:v8');
v8.setFlagsFromString('--trace_gc');
setTimeout(() => {
    v8.setFlagsFromString('--notrace_gc');
}, 60e3);
```


### `v8.stopCoverage()`[#](https://nodejs.org/docs/latest/api/v8.html#v8stopcoverage)

추가된 버전: v15.1.0, v14.18.0, v12.22.0

`v8.stopCoverage()` 메서드는 [`NODE_V8_COVERAGE`](https://nodejs.org/docs/latest/api/cli.html#node_v8_coveragedir)로 시작된 커버리지 수집을 중단할 수 있게 해줍니다. 이를 통해 V8은 실행 횟수 기록을 해제하고 코드를 최적화할 수 있습니다. 이 메서드는 필요할 때 커버리지를 수집하고자 할 때 [`v8.takeCoverage()`](https://nodejs.org/docs/latest/api/v8.html#v8takecoverage)와 함께 사용할 수 있습니다.


### `v8.takeCoverage()`[#](https://nodejs.org/docs/latest/api/v8.html#v8takecoverage)

추가된 버전: v15.1.0, v14.18.0, v12.22.0

`v8.takeCoverage()` 메서드는 [`NODE_V8_COVERAGE`](https://nodejs.org/docs/latest/api/cli.html#node_v8_coveragedir)로 시작된 커버리지를 필요할 때 디스크에 기록할 수 있게 해줍니다. 이 메서드는 프로세스가 실행되는 동안 여러 번 호출할 수 있습니다. 매번 호출할 때마다 실행 카운터가 초기화되고, 새로운 커버리지 보고서가 [`NODE_V8_COVERAGE`](https://nodejs.org/docs/latest/api/cli.html#node_v8_coveragedir)로 지정된 디렉토리에 기록됩니다.

프로세스가 종료되기 직전에, [`v8.stopCoverage()`](https://nodejs.org/docs/latest/api/v8.html#v8stopcoverage)를 호출하지 않으면 마지막 커버리지가 디스크에 기록됩니다.


### `v8.writeHeapSnapshot([filename[, options]])`

- `filename` [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) V8 힙 스냅샷을 저장할 파일 경로입니다. 지정하지 않으면 `'Heap-${yyyymmdd}-${hhmmss}-${pid}-${thread_id}.heapsnapshot'` 패턴의 파일 이름이 생성됩니다. 여기서 `{pid}`는 Node.js 프로세스의 PID이고, `{thread_id}`는 `writeHeapSnapshot()`이 메인 Node.js 스레드에서 호출된 경우 `0`, 워커 스레드에서 호출된 경우 해당 워커 스레드의 ID입니다.
- `options` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)
  - `exposeInternals` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) `true`로 설정하면 힙 스냅샷에 내부 정보를 노출합니다. **기본값:** `false`.
  - `exposeNumericValues` [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) `true`로 설정하면 인공 필드에 숫자 값을 노출합니다. **기본값:** `false`.
- 반환값: [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) 스냅샷이 저장된 파일 이름입니다.

현재 V8 힙의 스냅샷을 생성하고 JSON 파일로 저장합니다. 이 파일은 Chrome DevTools와 같은 도구에서 사용하기 위해 만들어졌습니다. JSON 스키마는 문서화되지 않았으며 V8 엔진에 특화되어 있어 V8 버전마다 변경될 수 있습니다.

힙 스냅샷은 단일 V8 isolate에 특정됩니다. [워커 스레드](https://nodejs.org/docs/latest/api/worker_threads.html)를 사용할 때, 메인 스레드에서 생성된 힙 스냅샷은 워커에 대한 정보를 포함하지 않으며, 그 반대도 마찬가지입니다.

힙 스냅샷을 생성하려면 스냅샷 생성 시점의 힙 크기보다 약 두 배 정도의 메모리가 필요합니다. 이로 인해 OOM 킬러가 프로세스를 종료할 위험이 있습니다.

스냅샷 생성은 동기 작업으로, 힙 크기에 따라 이벤트 루프가 일정 시간 동안 블로킹됩니다.

```js
const { writeHeapSnapshot } = require('node:v8');
const { Worker, isMainThread, parentPort } = require('node:worker_threads');

if (isMainThread) {
  const worker = new Worker(__filename);
  worker.once('message', (filename) => {
    console.log(`worker heapdump: ${filename}`);
    // 이제 메인 스레드의 힙덤프를 가져옵니다.
    console.log(`main thread heapdump: ${writeHeapSnapshot()}`);
  });
  // 워커에게 힙덤프를 생성하라고 알립니다.
  worker.postMessage('heapdump');
} else {
  parentPort.once('message', (message) => {
    if (message === 'heapdump') {
      // 워커의 힙덤프를 생성하고 파일 이름을 부모에게 반환합니다.
      parentPort.postMessage(writeHeapSnapshot());
    }
  });
}
```


### `v8.setHeapSnapshotNearHeapLimit(limit)`[#](https://nodejs.org/docs/latest/api/v8.html#v8setheapsnapshotnearheaplimitlimit)

추가된 버전: v18.10.0, v16.18.0

-   `limit` [`<integer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

이 API는 `--heapsnapshot-near-heap-limit`가 이미 커맨드라인에서 설정되었거나 API가 두 번 이상 호출된 경우 아무 동작도 하지 않습니다. `limit`은 반드시 양의 정수여야 합니다. 자세한 내용은 [`--heapsnapshot-near-heap-limit`](https://nodejs.org/docs/latest/api/cli.html#--heapsnapshot-near-heap-limitmax_count)를 참고하세요.


### 직렬화 API[#](https://nodejs.org/docs/latest/api/v8.html#serialization-api)

직렬화 API는 [HTML 구조화 복제 알고리즘](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm)과 호환되는 방식으로 JavaScript 값을 직렬화하는 방법을 제공합니다.

이 형식은 하위 호환성을 유지하며(즉, 디스크에 저장해도 안전합니다). 동일한 JavaScript 값이라도 다른 직렬화된 출력을 생성할 수 있습니다.


#### `v8.serialize(value)`[#](https://nodejs.org/docs/latest/api/v8.html#v8serializevalue)

추가된 버전: v8.0.0

-   `value` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)
-   반환값: [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer)

`value`를 버퍼로 직렬화하기 위해 [`DefaultSerializer`](https://nodejs.org/docs/latest/api/v8.html#class-v8defaultserializer)를 사용합니다.

너무 큰 객체를 직렬화하려고 할 때, [`buffer.constants.MAX_LENGTH`](https://nodejs.org/docs/latest/api/buffer.html#bufferconstantsmax_length)보다 큰 버퍼가 필요한 경우 [`ERR_BUFFER_TOO_LARGE`](https://nodejs.org/docs/latest/api/errors.html#err_buffer_too_large) 오류가 발생합니다.


#### `v8.deserialize(buffer)`[#](https://nodejs.org/docs/latest/api/v8.html#v8deserializebuffer)

추가된 버전: v8.0.0

-   `buffer` [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer) | [`<TypedArray>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray) | [`<DataView>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView) [`serialize()`](https://nodejs.org/docs/latest/api/v8.html#v8serializevalue) 함수에서 반환된 버퍼입니다.

기본 옵션을 사용하여 [`DefaultDeserializer`](https://nodejs.org/docs/latest/api/v8.html#class-v8defaultdeserializer)를 통해 버퍼에서 자바스크립트 값을 읽어옵니다.


#### 클래스: `v8.Serializer`[#](https://nodejs.org/docs/latest/api/v8.html#class-v8serializer)

추가된 버전: v8.0.0


##### `new Serializer()`[#](https://nodejs.org/docs/latest/api/v8.html#new-serializer)

새로운 `Serializer` 객체를 생성합니다.


##### `serializer.writeHeader()`[#](https://nodejs.org/docs/latest/api/v8.html#serializerwriteheader)

시리얼라이저의 헤더를 작성합니다. 이 헤더에는 시리얼라이제이션 포맷 버전이 포함됩니다.


##### `serializer.writeValue(value)`[#](https://nodejs.org/docs/latest/api/v8.html#serializerwritevaluevalue)

-   `value` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types)

자바스크립트 값을 직렬화하고, 직렬화된 표현을 내부 버퍼에 추가합니다.

`value`가 직렬화할 수 없는 경우 에러를 발생시킵니다.


##### `serializer.releaseBuffer()`[#](https://nodejs.org/docs/latest/api/v8.html#serializerreleasebuffer)

-   반환값: [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer)

저장된 내부 버퍼를 반환합니다. 이 메서드를 호출한 후에는 해당 시리얼라이저를 더 이상 사용할 수 없습니다. 이전 쓰기 작업이 실패한 상태에서 이 메서드를 호출하면 정의되지 않은 동작이 발생할 수 있습니다.


### `serializer.transferArrayBuffer(id, arrayBuffer)`

- `id` [`<integer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type): 32비트 부호 없는 정수입니다.
- `arrayBuffer` [`<ArrayBuffer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer): `ArrayBuffer` 인스턴스입니다.

이 메서드는 `ArrayBuffer`의 내용을 대역 외(Out-of-Band)로 전송하도록 표시합니다. 역직렬화(deserializing) 컨텍스트에서 해당 `ArrayBuffer`를 [`deserializer.transferArrayBuffer()`](https://nodejs.org/docs/latest/api/v8.html#deserializertransferarraybufferid-arraybuffer)에 전달해야 합니다.


### `serializer.writeUint32(value)`

- **`value`** [`<integer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

32비트 부호 없는 정수를 직접 기록합니다. 이 메서드는 커스텀 [`serializer._writeHostObject()`](https://nodejs.org/docs/latest/api/v8.html#serializer_writehostobjectobject) 내부에서 사용하기 위해 제공됩니다.

```javascript
// 예제: 32비트 부호 없는 정수 기록
serializer.writeUint32(123456);
```

이 메서드는 주어진 `value`를 32비트 부호 없는 정수로 직렬화합니다. `serializer._writeHostObject()` 메서드 내에서 특정 객체를 직렬화할 때 유용하게 사용할 수 있습니다.


### `serializer.writeUint64(hi, lo)`

- `hi` [`<integer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
- `lo` [`<integer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

64비트 부호 없는 정수를 상위 32비트와 하위 32비트로 나누어 기록합니다. 이 메서드는 커스텀 [`serializer._writeHostObject()`](https://nodejs.org/docs/latest/api/v8.html#serializer_writehostobjectobject) 내부에서 사용됩니다.

```javascript
// 예제: 64비트 정수를 상위 32비트와 하위 32비트로 나누어 기록
serializer.writeUint64(hi, lo);
```

이 메서드는 64비트 정수를 두 개의 32비트 정수로 분할하여 저장할 때 유용합니다. 주로 커스텀 직렬화 로직을 구현할 때 사용됩니다.


### `serializer.writeDouble(value)`

- **`value`** [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

자바스크립트 `number` 타입의 값을 기록합니다. 이 메서드는 커스텀 [`serializer._writeHostObject()`](https://nodejs.org/docs/latest/api/v8.html#serializer_writehostobjectobject) 내부에서 사용됩니다.

```javascript
serializer.writeDouble(3.14);
```

위 예제는 `3.14`라는 숫자 값을 기록합니다. 이 메서드는 주로 `serializer._writeHostObject()`에서 호스트 객체를 직렬화할 때 사용됩니다.


### `serializer.writeRawBytes(buffer)`

- **`buffer`** [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer) | [`<TypedArray>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray) | [`<DataView>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView)

이 메서드는 **직렬화기(serializer)**의 내부 버퍼에 **원시 바이트(raw bytes)**를 씁니다. **역직렬화기(deserializer)**는 이 버퍼의 길이를 계산할 방법이 필요합니다. 이 메서드는 주로 커스텀 [`serializer._writeHostObject()`](https://nodejs.org/docs/latest/api/v8.html#serializer_writehostobjectobject) 내부에서 사용됩니다.

```javascript
// 예제: serializer.writeRawBytes 사용법
const { Serializer } = require('v8');
const serializer = new Serializer();

const buffer = Buffer.from([0x01, 0x02, 0x03]);
serializer.writeRawBytes(buffer);
```

이 코드는 `Buffer`, `TypedArray`, 또는 `DataView` 타입의 데이터를 직렬화기의 내부 버퍼에 직접 기록합니다. 역직렬화 과정에서 이 데이터를 정확히 읽어내려면 버퍼의 길이를 알 수 있어야 합니다.


##### `serializer._writeHostObject(object)`[#](https://nodejs.org/docs/latest/api/v8.html#serializer_writehostobjectobject)

-   `object` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

이 메서드는 호스트 객체, 즉 네이티브 C++ 바인딩으로 생성된 객체를 직렬화하기 위해 호출됩니다. `object`를 직렬화할 수 없는 경우 적절한 예외를 던져야 합니다.

이 메서드는 `Serializer` 클래스 자체에는 존재하지 않지만, 서브클래스에서 제공할 수 있습니다.


##### `serializer._getDataCloneError(message)`

- `message` [`<string>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type)

이 메서드는 객체를 복제할 수 없을 때 발생할 에러 객체를 생성하기 위해 호출됩니다.

이 메서드는 기본적으로 [`Error`](https://nodejs.org/docs/latest/api/errors.html#class-error) 생성자를 사용하며, 서브클래스에서 재정의할 수 있습니다.


```javascript
serializer._getSharedArrayBufferId(sharedArrayBuffer)
```

- `sharedArrayBuffer` [`<SharedArrayBuffer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer)

이 메서드는 `SharedArrayBuffer` 객체를 직렬화할 때 호출됩니다. 이 메서드는 해당 객체에 대해 32비트 부호 없는 정수 ID를 반환해야 하며, 이미 직렬화된 `SharedArrayBuffer`인 경우 동일한 ID를 사용해야 합니다. 역직렬화 시 이 ID는 [`deserializer.transferArrayBuffer()`](https://nodejs.org/docs/latest/api/v8.html#deserializertransferarraybufferid-arraybuffer)에 전달됩니다.

객체를 직렬화할 수 없는 경우 예외가 발생해야 합니다.

이 메서드는 `Serializer` 클래스 자체에는 존재하지 않지만, 서브클래스에서 제공할 수 있습니다.


```javascript
serializer._setTreatArrayBufferViewsAsHostObjects(flag)
```

- `flag` [`<boolean>`] **기본값:** `false`

`TypedArray`와 `DataView` 객체를 호스트 객체로 취급할지 여부를 지정합니다. 이는 해당 객체들을 [`serializer._writeHostObject()`](https://nodejs.org/docs/latest/api/v8.html#serializer_writehostobjectobject)로 전달하는 것을 의미합니다.


#### 클래스: `v8.Deserializer`[#](https://nodejs.org/docs/latest/api/v8.html#class-v8deserializer)

추가된 버전: v8.0.0

`v8.Deserializer` 클래스는 Node.js의 V8 엔진에서 제공하는 기능으로, 직렬화된 데이터를 다시 원래의 객체로 복원하는 역할을 합니다. 이 클래스는 주로 데이터를 전송하거나 저장한 후에 다시 사용할 때 유용하게 활용됩니다. 

예를 들어, 네트워크를 통해 전송된 데이터나 파일에 저장된 데이터를 다시 객체로 변환할 때 `v8.Deserializer`를 사용할 수 있습니다. 이 클래스는 `v8.Serializer`와 함께 사용되며, `v8.Serializer`로 직렬화된 데이터를 `v8.Deserializer`로 역직렬화하여 원본 객체를 복원합니다.

```javascript
const v8 = require('v8');

// 객체를 직렬화
const data = v8.serialize({ key: 'value' });

// 직렬화된 데이터를 역직렬화
const deserializer = new v8.Deserializer(data);
const obj = deserializer.readValue();

console.log(obj); // { key: 'value' }
```

위 예제에서 `v8.serialize` 함수를 사용하여 객체를 직렬화하고, `v8.Deserializer`를 사용하여 직렬화된 데이터를 다시 객체로 복원합니다. 이 과정을 통해 데이터의 전송 및 저장이 용이해지며, 필요할 때 원본 객체를 쉽게 복원할 수 있습니다.


##### `new Deserializer(buffer)`[#](https://nodejs.org/docs/latest/api/v8.html#new-deserializerbuffer)

- `buffer` [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer) | [`<TypedArray>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray) | [`<DataView>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView)  
  [`serializer.releaseBuffer()`](https://nodejs.org/docs/latest/api/v8.html#serializerreleasebuffer)에서 반환된 버퍼입니다.

새로운 `Deserializer` 객체를 생성합니다.


##### `deserializer.readHeader()`[#](https://nodejs.org/docs/latest/api/v8.html#deserializerreadheader)

헤더를 읽고 검증합니다. 여기에는 포맷 버전도 포함됩니다. 예를 들어, 잘못되었거나 지원되지 않는 전송 포맷을 거부할 수 있습니다. 이 경우 `Error`가 발생합니다.


`deserializer.readValue()`는 버퍼에서 JavaScript 값을 역직렬화하여 반환합니다.


### `deserializer.transferArrayBuffer(id, arrayBuffer)`

- **`id`** [`<integer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)  
  32비트 부호 없는 정수입니다.

- **`arrayBuffer`** [`<ArrayBuffer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer) | [`<SharedArrayBuffer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer)  
  `ArrayBuffer` 인스턴스입니다.

이 메서드는 `ArrayBuffer`의 내용이 대역 외(Out-of-Band)로 전송되었음을 표시합니다. 직렬화(serializing) 컨텍스트에서 해당 `ArrayBuffer`를 [`serializer.transferArrayBuffer()`](https://nodejs.org/docs/latest/api/v8.html#serializertransferarraybufferid-arraybuffer)에 전달하거나, `SharedArrayBuffer`의 경우 [`serializer._getSharedArrayBufferId()`](https://nodejs.org/docs/latest/api/v8.html#serializer_getsharedarraybufferidsharedarraybuffer)에서 `id`를 반환합니다.


### `deserializer.getWireFormatVersion()`

- **반환값**: [`<integer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

이 메서드는 기본적인 와이어 포맷 버전을 읽어옵니다. 주로 오래된 와이어 포맷 버전을 읽는 레거시 코드에서 유용하게 사용될 수 있습니다. 단, `.readHeader()` 메서드를 호출하기 전에는 이 메서드를 사용할 수 없습니다.


### `deserializer.readUint32()`[#](https://nodejs.org/docs/latest/api/v8.html#deserializerreaduint32)

-   반환값: [`<integer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

32비트 부호 없는 정수를 읽어서 반환합니다. 이 메서드는 커스텀 [`deserializer._readHostObject()`](https://nodejs.org/docs/latest/api/v8.html#deserializer_readhostobject) 내부에서 사용됩니다.


### `deserializer.readUint64()`

- **반환값**: [`<integer[]>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

64비트 부호 없는 정수를 읽고, 이를 두 개의 32비트 부호 없는 정수로 구성된 배열 `[hi, lo]`로 반환합니다. 이 메서드는 커스텀 [`deserializer._readHostObject()`](https://nodejs.org/docs/latest/api/v8.html#deserializer_readhostobject) 내부에서 사용됩니다.


### `deserializer.readDouble()`

- **반환값**: [`<number>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)

이 메서드는 JS `number` 값을 읽어옵니다. 이 메서드는 커스텀 [`deserializer._readHostObject()`](https://nodejs.org/docs/latest/api/v8.html#deserializer_readhostobject) 내부에서 사용됩니다.


### `deserializer.readRawBytes(length)`

- **`length`** [`<integer>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)
- **반환값:** [`<Buffer>`](https://nodejs.org/docs/latest/api/buffer.html#class-buffer)

`deserializer`의 내부 버퍼에서 원시 바이트를 읽어옵니다. `length` 매개변수는 [`serializer.writeRawBytes()`](https://nodejs.org/docs/latest/api/v8.html#serializerwriterawbytesbuffer)에 전달된 버퍼의 길이와 일치해야 합니다. 이 메서드는 커스텀 [`deserializer._readHostObject()`](https://nodejs.org/docs/latest/api/v8.html#deserializer_readhostobject) 내부에서 사용됩니다.


### `deserializer._readHostObject()`[#](https://nodejs.org/docs/latest/api/v8.html#deserializer_readhostobject)

이 메서드는 **호스트 객체(host object)**를 읽기 위해 호출됩니다. 호스트 객체는 네이티브 C++ 바인딩에 의해 생성된 객체를 의미합니다. 데이터를 역직렬화할 수 없는 경우, 적절한 예외를 던져야 합니다.

이 메서드는 `Deserializer` 클래스 자체에 존재하지 않으며, 서브클래스에서 제공될 수 있습니다.


#### 클래스: `v8.DefaultSerializer`[#](https://nodejs.org/docs/latest/api/v8.html#class-v8defaultserializer)

추가된 버전: v8.0.0

[`Serializer`](https://nodejs.org/docs/latest/api/v8.html#class-v8serializer)의 하위 클래스로, `TypedArray` (특히 [`Buffer`](https://nodejs.org/docs/latest/api/buffer.html))와 `DataView` 객체를 호스트 객체로 직렬화합니다. 또한, 이들이 참조하고 있는 `ArrayBuffer`의 일부만 저장합니다.


#### 클래스: `v8.DefaultDeserializer`[#](https://nodejs.org/docs/latest/api/v8.html#class-v8defaultdeserializer)

추가된 버전: v8.0.0

[`DefaultSerializer`](https://nodejs.org/docs/latest/api/v8.html#class-v8defaultserializer)가 작성한 포맷에 대응하는 [`Deserializer`](https://nodejs.org/docs/latest/api/v8.html#class-v8deserializer)의 하위 클래스입니다.


### Promise hooks[#](https://nodejs.org/docs/latest/api/v8.html#promise-hooks)

`promiseHooks` 인터페이스는 Promise의 생명주기 이벤트를 추적하는 데 사용됩니다. **모든** 비동기 활동을 추적하려면 [`async_hooks`](https://nodejs.org/docs/latest/api/async_hooks.html)를 참조하세요. 이 모듈은 내부적으로 Promise 생명주기 이벤트와 다른 비동기 리소스의 이벤트를 생성하는 데 사용됩니다. 요청 컨텍스트 관리를 위해서는 [`AsyncLocalStorage`](https://nodejs.org/docs/latest/api/async_context.html#class-asynclocalstorage)를 참조하세요.

```js
import { promiseHooks } from 'node:v8';

// Promise는 네 가지 생명주기 이벤트를 생성합니다:
// `init` 이벤트는 Promise가 생성될 때 발생합니다. 
// 이는 `new Promise(...)`와 같은 직접적인 생성이나 `then()` 또는 `catch()`와 같은 연속 작업에서 발생할 수 있습니다.
// 또한 async 함수가 호출되거나 `await`를 사용할 때도 발생합니다.
// 연속 Promise가 생성되면 `parent`는 연속된 Promise가 됩니다.
function init(promise, parent) {
    console.log('a promise was created', { promise, parent });
}

// `settled` 이벤트는 Promise가 해결되거나 거부될 때 발생합니다.
// 이는 `Promise.resolve()`를 사용하여 비 Promise 입력을 처리할 때 동기적으로 발생할 수 있습니다.
function settled(promise) {
    console.log('a promise resolved or rejected', { promise });
}

// `before` 이벤트는 `then()` 또는 `catch()` 핸들러가 실행되기 직전이나 `await`가 실행을 재개하기 직전에 실행됩니다.
function before(promise) {
    console.log('a promise is about to call a then handler', { promise });
}

// `after` 이벤트는 `then()` 핸들러가 실행된 직후나 `await`가 다른 작업에서 재개된 후에 실행됩니다.
function after(promise) {
    console.log('a promise is done calling a then handler', { promise });
}

// 생명주기 훅은 개별적으로 시작하고 중지할 수 있습니다.
const stopWatchingInits = promiseHooks.onInit(init);
const stopWatchingSettleds = promiseHooks.onSettled(settled);
const stopWatchingBefores = promiseHooks.onBefore(before);
const stopWatchingAfters = promiseHooks.onAfter(after);

// 또는 그룹으로 시작하고 중지할 수도 있습니다.
const stopHookSet = promiseHooks.createHook({
    init,
    settled,
    before,
    after,
});

// 훅을 중지하려면 생성 시 반환된 함수를 호출합니다.
stopWatchingInits();
stopWatchingSettleds();
stopWatchingBefores();
stopWatchingAfters();
stopHookSet();
```


#### `promiseHooks.onInit(init)`[#](https://nodejs.org/docs/latest/api/v8.html#promisehooksoninitinit)

추가된 버전: v17.1.0, v16.14.0

-   `init` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) Promise가 생성될 때 호출되는 [`init` 콜백](https://nodejs.org/docs/latest/api/v8.html#initpromise-parent)입니다.
-   반환값: [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 훅을 중지하기 위해 호출하는 함수입니다.

**`init` 훅은 일반 함수여야 합니다. 비동기 함수를 제공하면 무한 마이크로태스크 루프가 발생하기 때문에 오류가 발생합니다.**

```js
import { promiseHooks } from 'node:v8';

const stop = promiseHooks.onInit((promise, parent) => {
    // Promise가 생성될 때 실행될 코드
});
```


#### `promiseHooks.onSettled(settled)`[#](https://nodejs.org/docs/latest/api/v8.html#promisehooksonsettledsettled)

추가된 버전: v17.1.0, v16.14.0

-   `settled` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) Promise가 이행(resolved)되거나 거부(rejected)될 때 호출되는 [`settled` 콜백](https://nodejs.org/docs/latest/api/v8.html#settledpromise)입니다.
-   반환값: [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 훅을 중지하기 위해 호출하는 함수입니다.

**`settled` 훅은 일반 함수여야 합니다. 비동기 함수를 제공하면 무한 마이크로태스크 루프가 발생하므로 오류가 발생합니다.**

```js
import { promiseHooks } from 'node:v8';

const stop = promiseHooks.onSettled((promise) => {
    // Promise가 이행되거나 거부될 때 실행될 코드
});
```


#### `promiseHooks.onBefore(before)`[#](https://nodejs.org/docs/latest/api/v8.html#promisehooksonbeforebefore)

추가된 버전: v17.1.0, v16.14.0

-   `before` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) Promise 연속 작업이 실행되기 전에 호출되는 [`before` 콜백](https://nodejs.org/docs/latest/api/v8.html#beforepromise)입니다.
-   반환값: [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 훅을 중지하기 위해 호출하는 함수입니다.

**`before` 훅은 일반 함수여야 합니다. 비동기 함수를 제공하면 무한 마이크로태스크 루프가 발생하므로 오류가 발생합니다.**

```js
import { promiseHooks } from 'node:v8';

const stop = promiseHooks.onBefore((promise) => {
    // Promise 연속 작업 전에 실행할 코드
});
```


#### `promiseHooks.onAfter(after)`[#](https://nodejs.org/docs/latest/api/v8.html#promisehooksonafterafter)

추가된 버전: v17.1.0, v16.14.0

-   `after` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) Promise 연속 실행 후 호출할 [`after` 콜백](https://nodejs.org/docs/latest/api/v8.html#afterpromise) 함수.
-   반환값: [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 훅을 중지하기 위해 호출할 함수.

**`after` 훅은 일반 함수여야 합니다. 비동기 함수를 제공하면 무한 마이크로태스크 루프가 발생하므로 오류가 발생합니다.**

```js
import { promiseHooks } from 'node:v8';

const stop = promiseHooks.onAfter((promise) => {
    // Promise 연속 실행 후 실행될 코드
});
```


#### `promiseHooks.createHook(callbacks)`[#](https://nodejs.org/docs/latest/api/v8.html#promisehookscreatehookcallbacks)

추가된 버전: v17.1.0, v16.14.0

-   `callbacks` [`<Object>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object) 등록할 [Hook Callbacks](https://nodejs.org/docs/latest/api/v8.html#hook-callbacks)
    -   `init` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) [`init` 콜백](https://nodejs.org/docs/latest/api/v8.html#initpromise-parent)
    -   `before` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) [`before` 콜백](https://nodejs.org/docs/latest/api/v8.html#beforepromise)
    -   `after` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) [`after` 콜백](https://nodejs.org/docs/latest/api/v8.html#afterpromise)
    -   `settled` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) [`settled` 콜백](https://nodejs.org/docs/latest/api/v8.html#settledpromise)
-   반환값: [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 훅을 비활성화하는 데 사용

**훅 콜백은 일반 함수여야 합니다. 비동기 함수를 제공하면 무한 마이크로태스크 루프가 발생하므로 오류가 발생합니다.**

각 Promise의 생명주기 이벤트에 대해 호출될 함수를 등록합니다.

`init()`, `before()`, `after()`, `settled()` 콜백은 Promise의 생명주기 동안 해당 이벤트가 발생할 때 호출됩니다.

모든 콜백은 선택 사항입니다. 예를 들어, Promise 생성만 추적하려면 `init` 콜백만 전달하면 됩니다. `callbacks`에 전달할 수 있는 모든 함수의 세부 사항은 [Hook Callbacks](https://nodejs.org/docs/latest/api/v8.html#hook-callbacks) 섹션에서 확인할 수 있습니다.

```js
import { promiseHooks } from 'node:v8';

const stopAll = promiseHooks.createHook({
    init(promise, parent) {},
});
```


#### 훅 콜백

Promise의 생명주기에서 주요 이벤트는 네 가지 영역으로 분류됩니다: Promise 생성, 연속 핸들러 호출 전/후 또는 await 주변, 그리고 Promise가 resolve되거나 reject될 때입니다.

이 훅들은 [`async_hooks`](https://nodejs.org/docs/latest/api/async_hooks.html)와 유사하지만 `destroy` 훅이 없습니다. 다른 종류의 비동기 리소스는 일반적으로 소켓이나 파일 디스크립터를 나타내며, 이들은 `destroy` 생명주기 이벤트를 표현하기 위해 명확한 "닫힘" 상태를 가지고 있습니다. 반면 Promise는 코드가 여전히 접근할 수 있는 한 계속 사용 가능합니다. 가비지 컬렉션 추적을 통해 Promise를 `async_hooks` 이벤트 모델에 맞추지만, 이 추적은 매우 비용이 많이 들며 반드시 가비지 컬렉션이 발생한다는 보장도 없습니다.

Promise는 비동기 리소스로, 그 생명주기는 Promise 훅 메커니즘을 통해 추적됩니다. 따라서 `init()`, `before()`, `after()`, `settled()` 콜백은 **절대** 비동기 함수가 되어서는 안 됩니다. 이들이 더 많은 Promise를 생성하면 무한 루프가 발생할 수 있기 때문입니다.

이 API는 Promise 이벤트를 [`async_hooks`](https://nodejs.org/docs/latest/api/async_hooks.html)에 전달하는 데 사용되지만, 두 API 간의 순서는 정의되지 않았습니다. 두 API 모두 다중 테넌트이므로 서로 상대적으로 어떤 순서로든 이벤트를 생성할 수 있습니다.


### `init(promise, parent)`

- `promise` [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) 생성된 Promise 객체입니다.
- `parent` [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) 이어지는 Promise 객체입니다. 해당되는 경우에만 사용됩니다.

이 함수는 Promise가 생성될 때 호출됩니다. 이는 해당 `before`/`after` 이벤트가 반드시 발생한다는 것을 의미하지 않으며, 단지 발생할 가능성이 있다는 것을 나타냅니다. 이는 Promise가 생성되었지만 이어지는 작업 없이 종료되는 경우에 발생할 수 있습니다.


##### `before(promise)`[#](https://nodejs.org/docs/latest/api/v8.html#beforepromise)

-   `promise` [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)

`before`는 Promise의 연속 작업이 실행되기 전에 호출됩니다. 이 연속 작업은 `then()`, `catch()`, `finally()` 핸들러나 `await`로 재개되는 경우일 수 있습니다.

`before` 콜백은 0번에서 N번까지 호출될 수 있습니다. Promise에 대한 연속 작업이 전혀 이루어지지 않았다면, `before` 콜백은 일반적으로 0번 호출됩니다. 반면, 동일한 Promise에서 여러 연속 작업이 이루어진 경우에는 `before` 콜백이 여러 번 호출될 수 있습니다.


##### `after(promise)`[#](https://nodejs.org/docs/latest/api/v8.html#afterpromise)

-   `promise` [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)

Promise 연속 작업이 실행된 직후에 호출됩니다. 이는 `then()`, `catch()`, 또는 `finally()` 핸들러가 실행된 후나, 다른 `await` 이후에 `await`가 실행되기 전에 발생할 수 있습니다.


##### `settled(promise)`[#](https://nodejs.org/docs/latest/api/v8.html#settledpromise)

-   `promise` [`<Promise>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)

이 함수는 Promise가 해결(resolve)되거나 거부(reject)될 때 호출됩니다. `Promise.resolve()`나 `Promise.reject()`와 같은 경우에는 동기적으로 발생할 수 있습니다.


### Startup Snapshot API[#](https://nodejs.org/docs/latest/api/v8.html#startup-snapshot-api)

추가된 버전: v18.6.0, v16.17.0

`v8.startupSnapshot` 인터페이스는 커스텀 스타트업 스냅샷을 위한 직렬화 및 역직렬화 훅을 추가하는 데 사용할 수 있습니다.

```console
$ node --snapshot-blob snapshot.blob --build-snapshot entry.js # 스냅샷을 사용하여 프로세스를 실행
$ node --snapshot-blob snapshot.blob
```

위 예제에서 `entry.js`는 `v8.startupSnapshot` 인터페이스의 메서드를 사용하여 스냅샷 직렬화 중에 커스텀 객체 정보를 저장하는 방법과 스냅샷 역직렬화 중에 이 정보를 사용하여 객체를 동기화하는 방법을 지정할 수 있습니다. 예를 들어, `entry.js`에 다음과 같은 스크립트가 포함되어 있다면:

```js
'use strict';
const fs = require('node:fs');
const zlib = require('node:zlib');
const path = require('node:path');
const assert = require('node:assert');
const v8 = require('node:v8');

class BookShelf {
    storage = new Map();

    // 디렉토리에서 일련의 파일을 읽어 storage에 저장
    constructor(directory, books) {
        for (const book of books) {
            this.storage.set(book, fs.readFileSync(path.join(directory, book)));
        }
    }

    // 모든 책을 압축
    static compressAll(shelf) {
        for (const [book, content] of shelf.storage) {
            shelf.storage.set(book, zlib.gzipSync(content));
        }
    }

    // 모든 책을 압축 해제
    static decompressAll(shelf) {
        for (const [book, content] of shelf.storage) {
            shelf.storage.set(book, zlib.gunzipSync(content));
        }
    }
}

// __dirname은 스냅샷 스크립트가 위치한 디렉토리
const shelf = new BookShelf(__dirname, [
    'book1.en_US.txt',
    'book1.es_ES.txt',
    'book2.zh_CN.txt',
]);

assert(v8.startupSnapshot.isBuildingSnapshot());

// 스냅샷 직렬화 시 책을 압축하여 크기 줄임
v8.startupSnapshot.addSerializeCallback(BookShelf.compressAll, shelf);

// 스냅샷 역직렬화 시 책을 압축 해제
v8.startupSnapshot.addDeserializeCallback(BookShelf.decompressAll, shelf);

v8.startupSnapshot.setDeserializeMainFunction((shelf) => {
    // process.env와 process.argv는 스냅샷 역직렬화 중에 갱신됨
    const lang = process.env.BOOK_LANG || 'en_US';
    const book = process.argv[1];
    const name = `${book}.${lang}.txt`;
    console.log(shelf.storage.get(name));
}, shelf);
```

결과로 생성된 바이너리는 스냅샷에서 역직렬화된 데이터를 시작 시 출력하며, 실행된 프로세스의 갱신된 `process.env`와 `process.argv`를 사용합니다:

```console
$ BOOK_LANG=es_ES node --snapshot-blob snapshot.blob book1 # 스냅샷에서 역직렬화된 book1.es_ES.txt의 내용 출력
```

현재 사용자 정의 스냅샷에서 역직렬화된 애플리케이션은 다시 스냅샷으로 저장할 수 없으므로, 이 API는 사용자 정의 스냅샷에서 역직렬화되지 않은 애플리케이션에서만 사용할 수 있습니다.


#### `v8.startupSnapshot.addSerializeCallback(callback[, data])`[#](https://nodejs.org/docs/latest/api/v8.html#v8startupsnapshotaddserializecallbackcallback-data)

추가된 버전: v18.6.0, v16.17.0

-   `callback` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 직렬화 전에 호출될 콜백 함수.
-   `data` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types) `callback`이 호출될 때 전달될 선택적 데이터.

Node.js 인스턴스가 스냅샷으로 직렬화되고 종료되기 직전에 호출될 콜백을 추가합니다. 이 기능은 직렬화되어서는 안 되거나 직렬화할 수 없는 리소스를 해제하거나, 사용자 데이터를 직렬화에 더 적합한 형태로 변환하는 데 사용할 수 있습니다.

콜백은 추가된 순서대로 실행됩니다.


#### `v8.startupSnapshot.addDeserializeCallback(callback[, data])`[#](https://nodejs.org/docs/latest/api/v8.html#v8startupsnapshotadddeserializecallbackcallback-data)

추가된 버전: v18.6.0, v16.17.0

-   `callback` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 스냅샷이 역직렬화된 후 호출될 콜백 함수.
-   `data` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types) 선택적 데이터로, `callback`이 호출될 때 전달됨.

Node.js 인스턴스가 스냅샷에서 역직렬화될 때 호출될 콜백을 추가합니다. `callback`과 `data`(제공된 경우)는 스냅샷에 직렬화되며, 애플리케이션이 스냅샷에서 재시작될 때 애플리케이션 상태를 다시 초기화하거나 필요한 리소스를 다시 획득하는 데 사용할 수 있습니다.

콜백은 추가된 순서대로 실행됩니다.


#### `v8.startupSnapshot.setDeserializeMainFunction(callback[, data])`[#](https://nodejs.org/docs/latest/api/v8.html#v8startupsnapshotsetdeserializemainfunctioncallback-data)

추가된 버전: v18.6.0, v16.17.0

-   `callback` [`<Function>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) 스냅샷이 역직렬화된 후 진입점으로 호출될 콜백 함수.
-   `data` [`<any>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Data_types) 콜백이 호출될 때 전달될 선택적 데이터.

이 함수는 스냅샷에서 역직렬화된 Node.js 애플리케이션의 진입점을 설정합니다. 이 함수는 스냅샷 빌드 스크립트에서 한 번만 호출할 수 있습니다. 이 함수를 호출하면, 역직렬화된 애플리케이션은 추가적인 진입점 스크립트 없이도 시작할 수 있으며, 제공된 데이터(있는 경우)와 함께 콜백을 호출합니다. 만약 이 함수를 호출하지 않으면, 역직렬화된 애플리케이션은 여전히 진입점 스크립트를 필요로 합니다.


#### `v8.startupSnapshot.isBuildingSnapshot()`[#](https://nodejs.org/docs/latest/api/v8.html#v8startupsnapshotisbuildingsnapshot)

추가된 버전: v18.6.0, v16.17.0

-   반환값: [`<boolean>`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)

Node.js 인스턴스가 스냅샷을 생성하기 위해 실행 중인 경우 `true`를 반환합니다.


### 클래스: `v8.GCProfiler`[#](https://nodejs.org/docs/latest/api/v8.html#class-v8gcprofiler)

추가된 버전: v19.6.0, v18.15.0

이 API는 현재 스레드에서 가비지 컬렉션(GC) 데이터를 수집합니다.


#### `new v8.GCProfiler()`[#](https://nodejs.org/docs/latest/api/v8.html#new-v8gcprofiler)

추가된 버전: v19.6.0, v18.15.0

`v8.GCProfiler` 클래스의 새로운 인스턴스를 생성합니다.


#### `profiler.start()`[#](https://nodejs.org/docs/latest/api/v8.html#profilerstart)

추가된 버전: v19.6.0, v18.15.0

GC(가비지 컬렉션) 데이터 수집을 시작합니다.


#### `profiler.stop()`[#](https://nodejs.org/docs/latest/api/v8.html#profilerstop)

추가된 버전: v19.6.0, v18.15.0

GC 데이터 수집을 중지하고 객체를 반환합니다. 반환된 객체의 내용은 다음과 같습니다.

```json
{ 
  "version": 1, 
  "startTime": 1674059033862, 
  "statistics": [ 
    { 
      "gcType": "Scavenge", 
      "beforeGC": { 
        "heapStatistics": { 
          "totalHeapSize": 5005312, 
          "totalHeapSizeExecutable": 524288, 
          "totalPhysicalSize": 5226496, 
          "totalAvailableSize": 4341325216, 
          "totalGlobalHandlesSize": 8192, 
          "usedGlobalHandlesSize": 2112, 
          "usedHeapSize": 4883840, 
          "heapSizeLimit": 4345298944, 
          "mallocedMemory": 254128, 
          "externalMemory": 225138, 
          "peakMallocedMemory": 181760 
        }, 
        "heapSpaceStatistics": [ 
          { 
            "spaceName": "read_only_space", 
            "spaceSize": 0, 
            "spaceUsedSize": 0, 
            "spaceAvailableSize": 0, 
            "physicalSpaceSize": 0 
          } 
        ] 
      }, 
      "cost": 1574.14, 
      "afterGC": { 
        "heapStatistics": { 
          "totalHeapSize": 6053888, 
          "totalHeapSizeExecutable": 524288, 
          "totalPhysicalSize": 5500928, 
          "totalAvailableSize": 4341101384, 
          "totalGlobalHandlesSize": 8192, 
          "usedGlobalHandlesSize": 2112, 
          "usedHeapSize": 4059096, 
          "heapSizeLimit": 4345298944, 
          "mallocedMemory": 254128, 
          "externalMemory": 225138, 
          "peakMallocedMemory": 181760 
        }, 
        "heapSpaceStatistics": [ 
          { 
            "spaceName": "read_only_space", 
            "spaceSize": 0, 
            "spaceUsedSize": 0, 
            "spaceAvailableSize": 0, 
            "physicalSpaceSize": 0 
          } 
        ] 
      } 
    } 
  ], 
  "endTime": 1674059036865 
}
```

다음은 예제 코드입니다.

```js
const { GCProfiler } = require('node:v8');
const profiler = new GCProfiler();
profiler.start();

setTimeout(() => {
  console.log(profiler.stop());
}, 1000);
```


